(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{520:function(s,a,t){"use strict";t.r(a);var n=t(22),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("Java web 环境搭建")]),s._v(" "),t("h4",{attrs:{id:"一、初识-tomcat"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、初识-tomcat"}},[s._v("#")]),s._v(" 一、初识 Tomcat")]),s._v(" "),t("p",[s._v("Tomcat 服务器是一个免费的开放源代码的 Web 应用服务器，属于轻量级应用服务器，在中小型系统和并发访问用户不是很多的场合下被普遍使用，是开发和调试 JSP 程序的首选。Tomcat 是 Apache 服务器的扩展，但运行时它是独立运行的，所以当你运行 tomcat 时，它实际上作为一个与 Apache 独立的进程单独运行的。")]),s._v(" "),t("h4",{attrs:{id:"二、java-web-环境-nginx-jdk-tomcat-mysql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、java-web-环境-nginx-jdk-tomcat-mysql"}},[s._v("#")]),s._v(" 二、Java web 环境：Nginx+JDK+Tomcat+MySQL")]),s._v(" "),t("p",[s._v("a. 所有服务部署在同一个主机上，也可分开部署\nb. Nginx 默认开启的是 80 端口，用来接收用户的 web 请求\nc. Tomcat 默认开启的是 8080 端口，用来接收 Nginx 转发过来的 web 请求")]),s._v(" "),t("h4",{attrs:{id:"三、环境部署流程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三、环境部署流程"}},[s._v("#")]),s._v(" 三、环境部署流程")]),s._v(" "),t("p",[s._v("1.安装 JDK（java 解析器）\n1、首先安装 gcc")]),s._v(" "),t("p",[s._v("yum -y install gcc")]),s._v(" "),t("p",[s._v("2、将软件包上传、解压、并移至指定位置")]),s._v(" "),t("p",[s._v("mv 解压缩目录 /usr/local/jdk1.7")]),s._v(" "),t("p",[s._v("3、配置 JDK 的环境变量")]),s._v(" "),t("p",[s._v("vim /etc/profile")]),s._v(" "),t("p",[s._v("#添加以下内容\nexport JAVA_HOME=/usr/local/jdk1.7 export JAVA_BIN=/usr/local/jdk1.7/bin export PATH=$PATH:$JAVA_HOME/bin\nexport CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar")]),s._v(" "),t("p",[s._v("source /etc/profile")]),s._v(" "),t("p",[s._v("4、查看 java 是否安装成功")]),s._v(" "),t("p",[s._v("java -version")]),s._v(" "),t("p",[s._v("2.安装 tomcat\n1、将软件包上传、解压、并复制到指定目录下")]),s._v(" "),t("p",[s._v("cp -a 解压目录 /usr/local/tomcat \t 2、配置 Tomcat 的环境变量")]),s._v(" "),t("p",[s._v("2、配置 Tomcat 的环境变量")]),s._v(" "),t("p",[s._v("vim /etc/profile")]),s._v(" "),t("p",[s._v("export TOMCAT_HOME=/usr/local/tomcat export PATH=$PATH:$TOMCAT_HOME/bin")]),s._v(" "),t("p",[s._v("source /etc/profile")]),s._v(" "),t("p",[s._v("3、将 tomcat 的启动脚本赋予执行权限")]),s._v(" "),t("p",[s._v("chmod +x /usr/local/tomcat/bin/* \t 4、开启 tomcat")]),s._v(" "),t("p",[s._v("4、开启 tomcat")]),s._v(" "),t("p",[s._v("/usr/local/tomcat/bin/catalina.sh start")]),s._v(" "),t("p",[s._v("netstat -antp\t#查看端口，确认是否启动")]),s._v(" "),t("p",[s._v("5、在客户端访问页面进行测试 192.168.10.20:8080")]),s._v(" "),t("p",[s._v("四、部署 JAVA 的 WAR 包")]),s._v(" "),t("p",[s._v("1、在 /usr/local/tomcat/conf/server.xml 配置文件中的 server 区域中添加标红内容")]),s._v(" "),t("p",[s._v("2、将 war 包拷贝到 webapps 目录中")]),s._v(" "),t("p",[s._v("cp -a test.war /usr/local/tomcat/webapps/ \t 4、删除网站的 ROOT 目录")]),s._v(" "),t("p",[s._v("rm -rf ROOT \t 4、重启 tomcat 服务")]),s._v(" "),t("p",[s._v("3、删除网站的 ROOT 目录")]),s._v(" "),t("p",[s._v("rm -rf ROOT")]),s._v(" "),t("p",[s._v("4、重启 tomcat 服务")]),s._v(" "),t("p",[s._v("/usr/local/tomcat/bin/catalina.sh stop")]),s._v(" "),t("p",[s._v("/usr/local/tomcat/bin/catalina.sh start")]),s._v(" "),t("p",[s._v("5、测试\n使用客户端浏览访问 Nginx 服务的端口")]),s._v(" "),t("p",[s._v("注意：原本的 tomcat 使用 8080 端口进行访问，也可以将端口修改为 80 使用 IP 直接访问，修改\n/usr/local/tomcat/conf/server.xml 配置中的 8080 改变为 80（切记不要和其他 web 服务器冲突）")]),s._v(" "),t("p",[s._v("五、创建多个 tomcat 实例（拓展）")]),s._v(" "),t("p",[s._v("1、首先将 tomcat 进行停止")]),s._v(" "),t("p",[s._v("/usr/local/tomcat/bin/catalina.sh stop \t 2、拷贝原来的 Tomcat 到另外一个目录，如 tomcat-2，清除 logs 目录")]),s._v(" "),t("p",[s._v("2、拷贝原来的 Tomcat 到另外一个目录，如 tomcat-2，清除 logs 目录")]),s._v(" "),t("p",[s._v("cp -a tomcat/ tomcat-2")]),s._v(" "),t("p",[s._v("rm -rf tomcat-2/logs/*")]),s._v(" "),t("p",[s._v("3、修改 Tomcat-2 中的/conf/server.xml 文件，把 shutdown 和 Connector 端口修改成另外的数值， 关闭端口修改为 8006，连接端口修改为 8090")]),s._v(" "),t("p",[s._v("4、修改 startup.sh 和 shutdown.sh 文件\n在第一行均加入：export CATALINA_HOME=/usr/local/tomcat-2\n5、启动 tomcat")]),s._v(" "),t("p",[s._v("/usr/local/tomcat/bin/catalina.sh start")]),s._v(" "),t("p",[s._v("/usr/local/tomcat-2/bin/catalina.sh start")]),s._v(" "),t("p",[s._v("netstat -antp\t#查看 8080 和 8090 端口是否正常启动")]),s._v(" "),t("p",[s._v("6、查看结果\n浏览 http://192.168.10.20:8080\n浏览 http://192.168.10.20:8090\n可以直接将 8090 写入配置好的 Nginx 负载均衡中")]),s._v(" "),t("p",[s._v("JSP WebApp目录结构\n主页配置：默认按以下顺序查找主页文件index.html，index.htm、index.jsp\nWEB-INF/：当前WebApp的私有资源路径，通常存储当前应用使用的web.xml和context.xml配置文件\nMETA-INF/：类似于WEB-INF，也是配置信息，浏览器无法访问\nclasses/：类文件，当前webapp需要的类\nlib/：当前应用依赖的jar包")]),s._v(" "),t("p",[s._v("基于部署实现WEB的管理")]),s._v(" "),t("p",[s._v("http://192.168.200.237:8090/manager/status")]),s._v(" "),t("p",[s._v("vim conf/tomcat-users.xml\n#加下面两行，指定用户和密码\n"),t("role",{attrs:{rolename:"manager-gui"}}),s._v(" "),t("user",{attrs:{username:"admin",password:"123456",roles:"manager-gui"}}),s._v('\n修改webapps/manager/META-INF/context.xml\n看正则表达式就知道是本地访问了，由于当前访问地址是192.168.x.x，可以修改正则为\nallow="127.\\d+.\\d+.\\d+|::1|0:0:0:0:0:0:0:1|192.168.\\d+.\\d+"')],1),s._v(" "),t("h4",{attrs:{id:"centos6启动脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#centos6启动脚本"}},[s._v("#")]),s._v(" centos6启动脚本")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash  ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tomcat startup script for the Tomcat server  ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chkconfig: 345 80 20  ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# description: start the tomcat deamon  ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Source function library  ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" /etc/rc.d/init.d/functions\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("prog")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("tomcat\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("JAVA_HOME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/jdk\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CLASSPATH")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(".:"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/lib/dt.jar:"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/lib/tools.jar\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/bin\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CATALANA_HOME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/tomcat8\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tomcat_port")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("\n \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v("\nstart"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tomcat_PID")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("netstat")]),s._v(" -nptl "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" $tomcat_port "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print $7}'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$tomcat_PID")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Tomcat had started"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Tomcat_PID="')]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${tomcat_PID}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"if you want to restart Tomcat,please excute restart command!"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Starting Tomcat..."')]),s._v("  \n        "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CATALANA_HOME")]),s._v("/bin/startup.sh\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nstop"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tomcat_PID")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("netstat")]),s._v(" -nptl "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" $tomcat_port "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print $7}'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$tomcat_PID")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Stopping Tomcat..."')]),s._v("  \n        "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CATALANA_HOME")]),s._v("/bin/shutdown.sh\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Tomcat hadn\'t started,please excute start command!"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nrestart"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#获取tomcat的进程ID")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#TomcatID=$(ps -ef |grep tomcat |grep -w $CATALANA_HOME|grep -v 'grep'|awk '{print $2}')")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tomcat_PID")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("netstat")]),s._v(" -nptl "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" $tomcat_port "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print $7}'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#echo "tomcat_PID="$tomcat_PID')]),s._v("\n \n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$tomcat_PID")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Tomcat had started,we will stopping Tomcat and Starting Tomcat next 2 second..."')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Stopping Tomcat..."')]),s._v("  \n        "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CATALANA_HOME")]),s._v("/bin/shutdown.sh\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"...............waiting 2 second.................."')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" -n "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Starting Tomcat..."')]),s._v("  \n        "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CATALANA_HOME")]),s._v("/bin/startup.sh\n \n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Tomcat hadn\'t starting"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" -n "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Starting Tomcat..."')]),s._v("  \n        "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CATALANA_HOME")]),s._v("/bin/startup.sh\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n \n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n*"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Usage: '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$prog")]),s._v(' {start|stop|restart}"')]),s._v("  \n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("esac")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br")])]),t("h4",{attrs:{id:"systemctl-启动脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#systemctl-启动脚本"}},[s._v("#")]),s._v(" systemctl 启动脚本")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Unit"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Description")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Tomcat\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#After=syslog.target network.target remote-fs.target nss-lookup.target")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("After")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("syslog.target network.target\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Service"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Type")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("forking\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Environment")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"JAVA_HOME=/opt/jdk"')]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecStart")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/tomcat8/bin/startup.sh\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecStop")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/tomcat8/bin/shutdown.sh\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PrivateTmp")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("User")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Group")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Install"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("WantedBy")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("multi-user.target\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h4",{attrs:{id:"tomcat参数优化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tomcat参数优化"}},[s._v("#")]),s._v(" tomcat参数优化")]),s._v(" "),t("p",[s._v("tomcat进行参数性能优化，具体优化的地方如下：")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[s._v("Linux内核的优化\n服务器资源配置的优化\nTomcat参数优化\n配置负载集群优化\n")])])]),t("p",[s._v("这里着重讲解tomcat 参数的优化：server.xml文件,关闭DNS 查询、配置最大并发等参数。\nmaxThreads：tomcat 起动的最大线程数，即同时处理的任务个数，默认值为200 acceptCount：当 tomcat起动的线程数达到最大时，接受排队的请求个数，默认值为 100 当然这些值都不是越大越好，需要根据实际情况来设定。可以基于测试的基础上来不断的调优分析。")]),s._v(" "),t("p",[s._v("打开/conf/server.xml")]),s._v(" "),t("Connector",{attrs:{port:"8080",protocol:"org.apache.coyote.http11.Http11NioProtocol",connectionTimeout:"20000",redirectPort:"8443",maxThreads:"5000",minSpareThreads:"20",acceptCount:"1000",disableUploadTimeout:"true",enableLookups:"false",URIEncoding:"UTF-8"}}),s._v(" "),t("p",[s._v("配置多个 tomcat 实例，方法也很简单，只需要在服务器上 cp 多个 tomcat，然后修改三个端口和发布目录即可，然后分别启动即可。")]),s._v(" "),t("p",[s._v("为了提升整个网站的性能，还需要在 tomcat 前面架设 nginx web 反向代理服务器，用以提高用户高速访问。")]),s._v(" "),t("p",[s._v("linux修改TOMCAT_HOME/bin/catalina.sh")]),s._v(" "),t("p",[s._v('JAVA_OPTS="-server -Xms32g -Xmx32g -XX:NewSize= -XX:MaxNewSize= "\n-server：服务器模式\n-Xms：堆内存初始化大小\n-Xmx：堆内存空间上限\n-XX:NewSize=：新生代空间初始化大小\n-XX:MaxNewSize=：新生代空间最大值')]),s._v(" "),t("p",[s._v('JAVA_OPTS="-server -Xms4g -Xmx4g -Xss512k -Xmn1g\n-XX:CMSInitiatingOccupancyFraction=65\n-XX:+AggressiveOpts\n-XX:+UseBiasedLocking\n-XX:+DisableExplicitGC\n-XX:MaxTenuringThreshold=10\n-XX:NewRatio=2\n-XX:PermSize=128m\n-XX:MaxPermSize=512m\n-XX:CMSFullGCsBeforeCompaction=5\n-XX:+ExplicitGCInvokesConcurrent\n-XX:+UseConcMarkSweepGC\n-XX:+UseParNewGC\n-XX:+CMSParallelRemarkEnabled\n-XX:+UseCMSCompactAtFullCollection\n-XX:LargePageSizeInBytes=128m\n-XX:+UseFastAccessorMethods"')]),s._v(" "),t("p",[s._v('常用属性：\nmaxThreads：最大线程数，默认200\nminSpareThreads：最小空闲线程数\nmaxSpareThreads：最大空闲线程数\nacceptCount：当启动线程满了之后，等待队列的最大长度，默认100\nURIEncoding：URI地址编码格式，中文建议使用UTF-8\nenableLookups：是否启用客户端主机名的DNS反向解析，缺省禁用，建议禁用，就使用客户端IP就行\ncompression：是否启用传输压缩机制，建议“on"，CPU和流量的平衡\ncompressionMinSize：启用压缩传输的数据流最小值，单位是字节\ncompressableMimeType：定义启用压缩功能的MIME')])],1)}),[],!1,null,null,null);a.default=e.exports}}]);