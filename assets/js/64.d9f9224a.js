(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{557:function(s,e,n){"use strict";n.r(e);var a=n(22),t=Object(a.a)({},(function(){var s=this,e=s.$createElement,n=s._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[s._v("cannot open packages index")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("error: rpmdb: BDB0113 Thread/process 21357/140557926295360 failed: BDB1507 Thread died in Berkeley DB library\nerror: db5 error(-30973) from dbenv->failchk: BDB0087 DB_RUNRECOVERY: Fatal error, run database recovery\nerror: cannot open Packages index using db5 -  (-30973)\nCRITICAL:yum.main:\nError: rpmdb open failed\n\nrm -f /var/lib/rpm/__db*\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("检查python")]),s._v(" "),n("p",[s._v("python -V 显示找不到目录")]),s._v(" "),n("p",[s._v("strace -tt -f python -V 提示找不到libpython.so.1.0\n变量指定了LD_LIBRARY_PATH的错误路径")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("/etc/ld.so.conf \n/etc/ld.so.conf.d\n\n/lib /lib64\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("Linux下指定动态链接库查找路径有以下方法，设置环境变量或修改配置文件。")]),s._v(" "),n("p",[s._v("环境变量\n设置环境变量LD_LIBRARY_PATH，当前session下立即生效，logout后失效")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/path/to/your/lib\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("可以将此命令添加到~/.bash_profile，后续login依然有效")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('# echo "export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/path/to/your/lib" >> ~/.bash_profile\n\n# source ~/.bash_profile\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("配置文件\n/etc下以ld.so开头的文件和目录，指定了动态链接库查找路径")]),s._v(" "),n("p",[s._v("/etc/ld.so.conf")]),s._v(" "),n("p",[s._v("支持include子配置文件，扩展之后，即包含一系列以逗号/冒号/TAB/换行符分隔的动态链接库目录")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("  # cat /etc/ld.so.conf\n\n  include ld.so.conf.d/*.conf\n/etc/ld.so.conf.d/\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("动态链接库路径配置文件，结构清晰，适合为某个特定项目指定动态链接库路径")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("/etc/ld.so.cache\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("内容是动态链接库的具体关联，本身是二进制文件，可使用ldconfig读取内容")]),s._v(" "),n("p",[s._v("修改ld.so.conf或ld.so.conf.d下添加配置文件后，运行ldconfig使之立即生效。")]),s._v(" "),n("p",[s._v("ldconfig命令在以下目录内查找动态链接库，建立关联，生成cache, 即 /etc/ld.so.cache")]),s._v(" "),n("p",[s._v("命令行指定目录\n/etc/ld.so.conf 指定目录")]),s._v(" "),n("p",[s._v("查看动态链接库关联")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("/lib\n/lib64\n/usr/lib\n/usr/lib64\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("查看动态链接库关联")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("ldconfig -p | less\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])])}),[],!1,null,null,null);e.default=t.exports}}]);