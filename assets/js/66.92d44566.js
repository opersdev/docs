(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{561:function(n,s,e){"use strict";e.r(s);var a=e(22),r=Object(a.a)({},(function(){var n=this,s=n.$createElement,e=n._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[e("p",[n._v("如何处理？现在，我尝试依靠反向素数，但是它不起作用，因为它使X崩溃：S\nxrandr --setprovideroutputsource nouveau模式设置\nxrandr-输出HDMI-1-1-自动-在eDP-1之上=>这会导致崩溃，并且根据bash的完成，我可以将DP-1或HDMI-1-1与eDP-1分开使用- -上面的参数...，但都以相同的方式失败（就像gnome-control-center在尝试使用其HDMI输出时所做的一样）")]),n._v(" "),e("p",[n._v("是的，不幸的是，除非您设法通过Nouveau启用它，否则我不知道确定此问题的更好方法。")]),n._v(" "),e("p",[n._v("您需要使用Nouveau作为主要驱动程序，即在xorg.conf中将其分配给屏幕。您仍然需要PRIME并指定“ --setprovideroutputsource Intel nouveau”才能使eDP在该配置下工作，但是即使这不起作用，也可以至少验证输出路由。")]),n._v(" "),e("p",[n._v("那里没有回复:(")]),n._v(" "),e("p",[n._v("但是我已经确认xrandr仅在运行xrandr --setprovideroutputsource nouveau modesetting后才报告HDMI-1端口")]),n._v(" "),e("p",[n._v("然后，它似乎已连接到nvidia卡：/")]),n._v(" "),e("p",[n._v("好的，看起来nouveau驱动程序需要通过PRIME或使用nouveau作为主要驱动程序来启用输出。由于上述原因，我正在关闭此文件，在i915输出设置中这不是问题。请针对您遇到的PRIME问题打开单独的错误；以及-如果不能通过将nouveau用作主要驱动程序使HDMI正常工作，则请打开另一个特定于nouveau的错误。")]),n._v(" "),e("p",[n._v("感谢您的报告。")]),n._v(" "),e("p",[n._v('acpi_osi=! acpi="windows 2009"')]),n._v(" "),e("p",[n._v("禁用nouveau\n笔记本双显卡安装NVIDIA闭源驱动")]),n._v(" "),e("p",[n._v("新建一个黑名单让系统启动的时候不去加载开源驱动")]),n._v(" "),e("p",[n._v("sudo vim /etc/modprobe.d/blacklist-nouveau.conf\n写入以下内容：")]),n._v(" "),e("p",[n._v("blacklist nouveau\noptions nouveau modeset=0\n按ESC键，输入 :wq 保存（注意有个冒号）")]),n._v(" "),e("p",[n._v("重新生成 kernel initramfs:")]),n._v(" "),e("p",[n._v("sudo update-initramfs -u\n然后重启")]),n._v(" "),e("p",[n._v("重新进入系统之后输入以下代码检查是否禁用成功")]),n._v(" "),e("p",[n._v("lsmod | grep nouveau")]),n._v(" "),e("p",[n._v("在设备升级新版内核后，发现没有 fb0 设备，开机没有打印 drm 相关的信息")]),n._v(" "),e("p",[n._v("首先是检查设备树，确认加入 panel 节点")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('panel: panel {\n        compatible = "lg,lb070wv8”, “simple-panel";\n        #address-cells = <1>;\n        #size-cells = <0>;\n        enable-gpios = <&pio 4 6 GPIO_ACTIVE_HIGH>;\n\n    port@0 {\n        reg = <0>;\n        #address-cells = <1>;\n       #size-cells = <0>;\n\n       panel_input: endpoint@0 {\n            reg = <0>;\n            remote-endpoint = <&tcon0_out_lcd>;\n        };\n    };\n};\n')])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br")])]),e("p",[n._v("其次是检查内核是否开启了相关的驱动，这里使用的是 lichepi nano，依赖的驱动是 SUN4I 系列的驱动")]),n._v(" "),e("p",[n._v("CONFIG_DRM_SUN4I=y\nCONFIG_DRM_SUN4I_HDMI=y\nCONFIG_DRM_SUN4I_BACKEND=y\n不过在检查完上面两个地方没有问题后，还是没有解决问题")]),n._v(" "),e("p",[n._v("为了获取 drm 启动过程中的更多信息，在 uboot 的 bootargs 中加入 drm.debug=0x1f debug ，让内核打印 drm 的更多信息")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("[    1.079849] [drm:drm_core_init] Initialized\n[    1.084524] [drm:sun4i_drv_probe] Adding component /soc/display-backend@1e60000\n[    1.092143] [drm:sun4i_drv_probe] Adding component /soc/lcd-controller@1c0c000\n[    1.099606] [drm:sun4i_drv_probe] Adding component /panel\n[    1.105025] [drm:sun4i_drv_traverse_endpoints] No output to bind on port 1\n[    1.124695] [drm:compare_of] Comparing of node /soc/lcd-controller@1c0c000 with /soc/display-backend@1e60000\n...\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br")])]),e("p",[n._v("发现内核尝试着挂载 /panel 节点，这个本来是不用挂载的")]),n._v(" "),e("p",[n._v("修改 suniv_quirks，加上 has_channel_0 的配置。缺少 has_channel_0 会让内核认为这个 TCON 没有 RGB 口")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("static const struct sun4i_tcon_quirks suniv_quirks = {\n    .has_channel_0        = true,\n    .has_channel_1      = true,\n};\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br")])]),e("p",[n._v("重新编译烧录后，drm 的启动信息如下。内核没有再去挂载 /panel 节点了，不过 drm 的启动还是没有成功")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("[    1.079943] [drm:drm_core_init] Initialized\n[    1.084616] [drm:sun4i_drv_probe] Adding component /soc/display-backend@1e60000\n[    1.092235] [drm:sun4i_drv_probe] Adding component /soc/lcd-controller@1c0c000\n[    1.099662] [drm:sun4i_drv_traverse_endpoints] Endpoint is our panel... skipping\n[    1.121843] [drm:compare_of] Comparing of node /soc/display-backend@1e60000 with /soc/display-backend@1e60000\n[    1.131931] [drm:compare_of] Comparing of node /soc/display-backend@1e60000 with /soc/lcd-controller@1c0c000\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br")])]),e("p",[n._v("后来在看到了这份 commit 中说的内容，将 .has_channel_1 屏蔽掉，drm 正常工作了")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("static const struct sun4i_tcon_quirks suniv_f1c100s_quirks = {\n    /*\n     * The F1C100s SoC has a second channel in TCON, but the clock input of\n     * it is not documented.\n     */\n    .has_channel_0      = true,\n    /* .has_channel_1   = true, */\n};\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br")])])])}),[],!1,null,null,null);s.default=r.exports}}]);