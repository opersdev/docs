<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>shell编程 | 小诺文档中心</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_3077305_pt8umhrn4k9.css">
    <meta name="description" content="运维技术文档,mysql,k8s,docker,linux,shell,python等技术文章。">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <meta name="keywords" content="运维技术文档,mysql,k8s,docker,linux,shell,python,技术文档,学习,面试,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.92233c96.css" as="style"><link rel="preload" href="/assets/js/app.38f1b0a4.js" as="script"><link rel="preload" href="/assets/js/2.6beb1dc7.js" as="script"><link rel="preload" href="/assets/js/12.aa21f453.js" as="script"><link rel="prefetch" href="/assets/js/10.4365b950.js"><link rel="prefetch" href="/assets/js/100.8dac6c81.js"><link rel="prefetch" href="/assets/js/101.a5556ac1.js"><link rel="prefetch" href="/assets/js/102.e3ff38b9.js"><link rel="prefetch" href="/assets/js/103.3bcf44f5.js"><link rel="prefetch" href="/assets/js/104.6d56e53e.js"><link rel="prefetch" href="/assets/js/105.4fc9762e.js"><link rel="prefetch" href="/assets/js/106.f507561a.js"><link rel="prefetch" href="/assets/js/107.6c94c756.js"><link rel="prefetch" href="/assets/js/108.f7ff1945.js"><link rel="prefetch" href="/assets/js/109.aeb1e532.js"><link rel="prefetch" href="/assets/js/11.fe1ff844.js"><link rel="prefetch" href="/assets/js/110.dda67b83.js"><link rel="prefetch" href="/assets/js/111.5b990f24.js"><link rel="prefetch" href="/assets/js/112.0a27d3a0.js"><link rel="prefetch" href="/assets/js/113.972cd001.js"><link rel="prefetch" href="/assets/js/114.875814a1.js"><link rel="prefetch" href="/assets/js/115.ec235d59.js"><link rel="prefetch" href="/assets/js/116.03bd2386.js"><link rel="prefetch" href="/assets/js/117.68765825.js"><link rel="prefetch" href="/assets/js/118.9d6d0255.js"><link rel="prefetch" href="/assets/js/119.ff84a82f.js"><link rel="prefetch" href="/assets/js/120.20639785.js"><link rel="prefetch" href="/assets/js/121.6c546150.js"><link rel="prefetch" href="/assets/js/122.48e85de5.js"><link rel="prefetch" href="/assets/js/123.fc931745.js"><link rel="prefetch" href="/assets/js/124.797d5fda.js"><link rel="prefetch" href="/assets/js/125.b23a31c7.js"><link rel="prefetch" href="/assets/js/126.d7a182fd.js"><link rel="prefetch" href="/assets/js/127.167a63d6.js"><link rel="prefetch" href="/assets/js/128.878d4a7e.js"><link rel="prefetch" href="/assets/js/129.a8957dfa.js"><link rel="prefetch" href="/assets/js/13.161be064.js"><link rel="prefetch" href="/assets/js/130.3961a295.js"><link rel="prefetch" href="/assets/js/131.9c4e7a56.js"><link rel="prefetch" href="/assets/js/132.41d26584.js"><link rel="prefetch" href="/assets/js/133.6d91047e.js"><link rel="prefetch" href="/assets/js/134.121ecf0e.js"><link rel="prefetch" href="/assets/js/135.6e30234c.js"><link rel="prefetch" href="/assets/js/136.6fab7ce4.js"><link rel="prefetch" href="/assets/js/137.209af36e.js"><link rel="prefetch" href="/assets/js/138.660f236e.js"><link rel="prefetch" href="/assets/js/139.81c29d19.js"><link rel="prefetch" href="/assets/js/14.d0f13635.js"><link rel="prefetch" href="/assets/js/140.d8f594ca.js"><link rel="prefetch" href="/assets/js/141.89fbea1c.js"><link rel="prefetch" href="/assets/js/142.643bccec.js"><link rel="prefetch" href="/assets/js/143.f270bffc.js"><link rel="prefetch" href="/assets/js/144.cf6f4c9a.js"><link rel="prefetch" href="/assets/js/145.093699b5.js"><link rel="prefetch" href="/assets/js/146.876575d0.js"><link rel="prefetch" href="/assets/js/147.dc120635.js"><link rel="prefetch" href="/assets/js/148.4a3ba80f.js"><link rel="prefetch" href="/assets/js/149.4afb7469.js"><link rel="prefetch" href="/assets/js/15.af46dbb5.js"><link rel="prefetch" href="/assets/js/150.4eb38cf2.js"><link rel="prefetch" href="/assets/js/151.4fe6a931.js"><link rel="prefetch" href="/assets/js/16.4cbf8beb.js"><link rel="prefetch" href="/assets/js/17.1da2b6ae.js"><link rel="prefetch" href="/assets/js/18.0402bfbf.js"><link rel="prefetch" href="/assets/js/19.230bfe93.js"><link rel="prefetch" href="/assets/js/20.0d20ddb2.js"><link rel="prefetch" href="/assets/js/21.9dbdbc8b.js"><link rel="prefetch" href="/assets/js/22.1410508d.js"><link rel="prefetch" href="/assets/js/23.63089216.js"><link rel="prefetch" href="/assets/js/24.e6fe9306.js"><link rel="prefetch" href="/assets/js/25.1240d0c9.js"><link rel="prefetch" href="/assets/js/26.0f4fb46d.js"><link rel="prefetch" href="/assets/js/27.5b193a22.js"><link rel="prefetch" href="/assets/js/28.90e27733.js"><link rel="prefetch" href="/assets/js/29.cdb75f6c.js"><link rel="prefetch" href="/assets/js/3.1229de89.js"><link rel="prefetch" href="/assets/js/30.23c0524a.js"><link rel="prefetch" href="/assets/js/31.bc292e1e.js"><link rel="prefetch" href="/assets/js/32.79645dcf.js"><link rel="prefetch" href="/assets/js/33.53e29142.js"><link rel="prefetch" href="/assets/js/34.7ce01d2e.js"><link rel="prefetch" href="/assets/js/35.bcdc888c.js"><link rel="prefetch" href="/assets/js/36.00ce19aa.js"><link rel="prefetch" href="/assets/js/37.e53fea30.js"><link rel="prefetch" href="/assets/js/38.1b84e50f.js"><link rel="prefetch" href="/assets/js/39.ed0470cb.js"><link rel="prefetch" href="/assets/js/4.93dbb352.js"><link rel="prefetch" href="/assets/js/40.010f2420.js"><link rel="prefetch" href="/assets/js/41.7aefa9d2.js"><link rel="prefetch" href="/assets/js/42.eadeaa1f.js"><link rel="prefetch" href="/assets/js/43.012419aa.js"><link rel="prefetch" href="/assets/js/44.aa86bffd.js"><link rel="prefetch" href="/assets/js/45.b7ce8c1a.js"><link rel="prefetch" href="/assets/js/46.bd51c47b.js"><link rel="prefetch" href="/assets/js/47.71d2a52e.js"><link rel="prefetch" href="/assets/js/48.71b9430b.js"><link rel="prefetch" href="/assets/js/49.d92deee5.js"><link rel="prefetch" href="/assets/js/5.9228d2a8.js"><link rel="prefetch" href="/assets/js/50.2827e7a9.js"><link rel="prefetch" href="/assets/js/51.94c41d82.js"><link rel="prefetch" href="/assets/js/52.73681932.js"><link rel="prefetch" href="/assets/js/53.4db7ebcf.js"><link rel="prefetch" href="/assets/js/54.8e6699ab.js"><link rel="prefetch" href="/assets/js/55.3d832a8c.js"><link rel="prefetch" href="/assets/js/56.43282683.js"><link rel="prefetch" href="/assets/js/57.ea8d4f37.js"><link rel="prefetch" href="/assets/js/58.12ff8ca5.js"><link rel="prefetch" href="/assets/js/59.47100612.js"><link rel="prefetch" href="/assets/js/6.341b2c5d.js"><link rel="prefetch" href="/assets/js/60.914e7e2d.js"><link rel="prefetch" href="/assets/js/61.d9414480.js"><link rel="prefetch" href="/assets/js/62.a3747f73.js"><link rel="prefetch" href="/assets/js/63.1a2e54c1.js"><link rel="prefetch" href="/assets/js/64.d9f9224a.js"><link rel="prefetch" href="/assets/js/65.53e3f7bd.js"><link rel="prefetch" href="/assets/js/66.92d44566.js"><link rel="prefetch" href="/assets/js/67.67aba1d2.js"><link rel="prefetch" href="/assets/js/68.acce7dfb.js"><link rel="prefetch" href="/assets/js/69.3dacbd45.js"><link rel="prefetch" href="/assets/js/7.3d063b98.js"><link rel="prefetch" href="/assets/js/70.b40c0f61.js"><link rel="prefetch" href="/assets/js/71.51b34635.js"><link rel="prefetch" href="/assets/js/72.498f4ff0.js"><link rel="prefetch" href="/assets/js/73.b22c0978.js"><link rel="prefetch" href="/assets/js/74.823f2a12.js"><link rel="prefetch" href="/assets/js/75.d24d261d.js"><link rel="prefetch" href="/assets/js/76.44db605e.js"><link rel="prefetch" href="/assets/js/77.efce42e9.js"><link rel="prefetch" href="/assets/js/78.11405a06.js"><link rel="prefetch" href="/assets/js/79.9f0076d7.js"><link rel="prefetch" href="/assets/js/8.812a9a47.js"><link rel="prefetch" href="/assets/js/80.4fc1dc52.js"><link rel="prefetch" href="/assets/js/81.f8963444.js"><link rel="prefetch" href="/assets/js/82.627d5503.js"><link rel="prefetch" href="/assets/js/83.49c45765.js"><link rel="prefetch" href="/assets/js/84.b2045805.js"><link rel="prefetch" href="/assets/js/85.420cfd4a.js"><link rel="prefetch" href="/assets/js/86.06ff7ec2.js"><link rel="prefetch" href="/assets/js/87.4dfb234a.js"><link rel="prefetch" href="/assets/js/88.079f044f.js"><link rel="prefetch" href="/assets/js/89.bb76f78f.js"><link rel="prefetch" href="/assets/js/9.8be13208.js"><link rel="prefetch" href="/assets/js/90.ae61c8f3.js"><link rel="prefetch" href="/assets/js/91.8728eb6a.js"><link rel="prefetch" href="/assets/js/92.0d8581e8.js"><link rel="prefetch" href="/assets/js/93.e05baea5.js"><link rel="prefetch" href="/assets/js/94.c661a216.js"><link rel="prefetch" href="/assets/js/95.5414604a.js"><link rel="prefetch" href="/assets/js/96.529def2c.js"><link rel="prefetch" href="/assets/js/97.fb2d6168.js"><link rel="prefetch" href="/assets/js/98.69e544d7.js"><link rel="prefetch" href="/assets/js/99.a7993a79.js">
    <link rel="stylesheet" href="/assets/css/0.styles.92233c96.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="小诺文档中心" class="logo"> <span class="site-name can-hide">小诺文档中心</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="https://opersdev.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  小诺博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/devops/" class="nav-link">DevOps</a></div><div class="nav-item"><a href="/k8s/" class="nav-link">云原生</a></div><div class="nav-item"><a href="/technology/" class="nav-link">技术</a></div><div class="nav-item"><a href="/more/" class="nav-link">更多</a></div><div class="nav-item"><a href="/wzdh/" class="nav-link">网址导航</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/opersdev" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://cdn.jsdelivr.net/gh/opersdev/docs/img/touxiang.jpg"> <div class="blogger-info"><h3>kevin</h3> <span>运维界的菜鸟</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="https://opersdev.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  小诺博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/devops/" class="nav-link">DevOps</a></div><div class="nav-item"><a href="/k8s/" class="nav-link">云原生</a></div><div class="nav-item"><a href="/technology/" class="nav-link">技术</a></div><div class="nav-item"><a href="/more/" class="nav-link">更多</a></div><div class="nav-item"><a href="/wzdh/" class="nav-link">网址导航</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/opersdev" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>shell编程</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/8a368c/" aria-current="page" class="active sidebar-link">shell编程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/8a368c/#终端打印" class="sidebar-link">终端打印</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#echo" class="sidebar-link">echo</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#printf" class="sidebar-link">printf</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#在echo中转义换行符" class="sidebar-link">在echo中转义换行符</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#打印彩色输出" class="sidebar-link">打印彩色输出</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/8a368c/#算术运算" class="sidebar-link">算术运算</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#整数运算" class="sidebar-link">整数运算</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#精密计算" class="sidebar-link">精密计算</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/8a368c/#常用变量" class="sidebar-link">常用变量</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#用户自定义变量" class="sidebar-link">用户自定义变量</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#环境变量" class="sidebar-link">环境变量</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#位置变量" class="sidebar-link">位置变量</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#预定义变量" class="sidebar-link">预定义变量</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#系统预留文件描述符" class="sidebar-link">系统预留文件描述符</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#tee命令" class="sidebar-link">tee命令</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#重定向脚本内的文本片段-多行文本" class="sidebar-link">重定向脚本内的文本片段（多行文本）</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#自定义文件描述符" class="sidebar-link">自定义文件描述符</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#数组" class="sidebar-link">数组</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#关联数组" class="sidebar-link">关联数组</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#别名" class="sidebar-link">别名</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#shell函数的定义、执行与传参" class="sidebar-link">shell函数的定义、执行与传参</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#递归函数" class="sidebar-link">递归函数</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/8a368c/#条件测试操作" class="sidebar-link">条件测试操作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#常用测试操作" class="sidebar-link">常用测试操作</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#测试文件" class="sidebar-link">测试文件</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#字符串比较" class="sidebar-link">字符串比较</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#整数值比较" class="sidebar-link">整数值比较</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#逻辑测试" class="sidebar-link">逻辑测试</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/8a368c/#流程控制语句" class="sidebar-link">流程控制语句</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#if条件语句" class="sidebar-link">if条件语句</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#for循环语句" class="sidebar-link">for循环语句</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#while循环语句" class="sidebar-link">while循环语句</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#case多重分支语句" class="sidebar-link">case多重分支语句</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#until循环语句" class="sidebar-link">until循环语句</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#shift迁移语句" class="sidebar-link">shift迁移语句</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#循环控制语句" class="sidebar-link">循环控制语句</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#内部字段分隔符" class="sidebar-link">内部字段分隔符</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#shell脚本的调试" class="sidebar-link">Shell脚本的调试</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#语法" class="sidebar-link">语法</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#选项" class="sidebar-link">选项</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#参数" class="sidebar-link">参数</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#实例" class="sidebar-link">实例</a></li><li class="sidebar-sub-header level4"><a href="/pages/8a368c/#根据文件或者正则表达式进行匹配" class="sidebar-link">根据文件或者正则表达式进行匹配</a></li><li class="sidebar-sub-header level4"><a href="/pages/8a368c/#否定参数" class="sidebar-link">否定参数</a></li><li class="sidebar-sub-header level4"><a href="/pages/8a368c/#根据文件类型进行搜索" class="sidebar-link">根据文件类型进行搜索</a></li><li class="sidebar-sub-header level4"><a href="/pages/8a368c/#基于目录深度搜索" class="sidebar-link">基于目录深度搜索</a></li><li class="sidebar-sub-header level4"><a href="/pages/8a368c/#根据文件时间戳进行搜索" class="sidebar-link">根据文件时间戳进行搜索</a></li><li class="sidebar-sub-header level4"><a href="/pages/8a368c/#根据文件大小进行匹配" class="sidebar-link">根据文件大小进行匹配</a></li><li class="sidebar-sub-header level4"><a href="/pages/8a368c/#删除匹配文件" class="sidebar-link">删除匹配文件</a></li><li class="sidebar-sub-header level4"><a href="/pages/8a368c/#根据文件权限-所有权进行匹配" class="sidebar-link">根据文件权限/所有权进行匹配</a></li><li class="sidebar-sub-header level4"><a href="/pages/8a368c/#借助-exec选项与其他命令结合使用" class="sidebar-link">借助-exec选项与其他命令结合使用</a></li><li class="sidebar-sub-header level4"><a href="/pages/8a368c/#搜索但跳出指定的目录" class="sidebar-link">搜索但跳出指定的目录</a></li><li class="sidebar-sub-header level4"><a href="/pages/8a368c/#find其他技巧收集" class="sidebar-link">find其他技巧收集</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#xargs命令用法" class="sidebar-link">xargs命令用法</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#子shell-subshells" class="sidebar-link">子Shell（Subshells）</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#语法-2" class="sidebar-link">语法</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#选项-2" class="sidebar-link">选项</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#参数-2" class="sidebar-link">参数</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#实例-2" class="sidebar-link">实例</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#语法-3" class="sidebar-link">语法</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#选项-3" class="sidebar-link">选项</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#参数-3" class="sidebar-link">参数</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#日期格式字符串列表" class="sidebar-link">日期格式字符串列表</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#实例-3" class="sidebar-link">实例</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#语法-4" class="sidebar-link">语法</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#选项-4" class="sidebar-link">选项</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#实例-4" class="sidebar-link">实例</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#语法-5" class="sidebar-link">语法</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#选项-5" class="sidebar-link">选项</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#实例-5" class="sidebar-link">实例</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/8a368c/#expect自动化交互程序" class="sidebar-link">Expect自动化交互程序</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#_1-spawn命令" class="sidebar-link">1.spawn命令</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#_2-expect命令" class="sidebar-link">2.expect命令</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#_3-expect实践" class="sidebar-link">3.expect实践</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#_4-命令简介" class="sidebar-link">4.命令简介</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#_5-expect关键字" class="sidebar-link">5.Expect关键字</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#_6-企业应用" class="sidebar-link">6.企业应用</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#_7-关于使用expect自动退出" class="sidebar-link">7.关于使用expect自动退出</a></li><li class="sidebar-sub-header level3"><a href="/pages/8a368c/#_8-设置变量" class="sidebar-link">8.设置变量</a></li></ul></li></ul></li><li><a href="/pages/0c4eab/" class="sidebar-link">shell正则表达式</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>消息队列</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>web</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ELK</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>自动化运维</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>linux</span> <span class="arrow right"></span></p> <!----></section></li></ul> <div class="sidebar-slot sidebar-slot-bottom"><!-- 正方形 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="3508773082"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div></aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/devops/#DevOps" data-v-06225672>DevOps</a></li><li data-v-06225672><a href="/devops/#shell编程" data-v-06225672>shell编程</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/opersdev" target="_blank" title="作者" class="beLink" data-v-06225672>xiaonuo</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2022-06-18</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">shell编程<!----></h1> <div class="page-slot page-slot-top"><!-- 固定100% * 90px可显示，max-height:90px未见显示-->
     <ins class="adsbygoogle"
          style="display:inline-block;width:100%;max-height:90px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6625304284"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="theme-vdoing-content content__default"><h1 id="端打印、算术运算、常用变量"><a href="#端打印、算术运算、常用变量" class="header-anchor">#</a> 端打印、算术运算、常用变量</h1> <p><code>#!</code>称为 <a href="http://zh.wikipedia.org/zh-hant/Shebang" target="_blank" rel="noopener noreferrer">shebang<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><code>cmd1 ; cmd2</code>执行cmd1后在执行cmd2</p> <h2 id="终端打印"><a href="#终端打印" class="header-anchor">#</a> 终端打印</h2> <h3 id="echo"><a href="#echo" class="header-anchor">#</a> echo</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>echo hello world
echo 'hello world'
echo &quot;hello world&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>bash不会对单引号内变量（如<code>$var</code>）求值。</p> <h3 id="printf"><a href="#printf" class="header-anchor">#</a> printf</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>printf &quot;hello world&quot;
#!/bin/bash

printf &quot;%-5s %-10s %-4s\n&quot; NO Name Mark
printf &quot;%-5s %-10s %-4.2f\n&quot; 01 Tom 90.3456
printf &quot;%-5s %-10s %-4.2f\n&quot; 02 Jack 89.2345
printf &quot;%-5s %-10s %-4.2f\n&quot; 03 Jeff 98.4323
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>%-5s 格式为左对齐且宽度为5的字符串代替（-表示左对齐），不使用则是又对齐。</li> <li>%-4.2f 格式为左对齐宽度为4，保留两位小数。</li></ul> <p><strong>格式替代符</strong></p> <ul><li>%b 相对应的参数被视为含有要被处理的转义序列之字符串。</li> <li>%c ASCII字符。显示相对应参数的第一个字符</li> <li>%d, %i 十进制整数</li> <li>%e, %E, %f 浮点格式</li> <li>%g %e或%f转换，看哪一个较短，则删除结尾的零</li> <li>%G %E或%f转换，看哪一个较短，则删除结尾的零</li> <li>%o 不带正负号的八进制值</li> <li>%s 字符串</li> <li>%u 不带正负号的十进制值</li> <li>%x 不带正负号的十六进制值，使用a至f表示10至15</li> <li>%X 不带正负号的十六进制值，使用A至F表示10至15</li> <li>%% 字面意义的%</li></ul> <p><strong>转义序列</strong></p> <ul><li>\a 警告字符，通常为ASCII的BEL字符</li> <li>\b 后退</li> <li>\c 抑制（不显示）输出结果中任何结尾的换行字符（只在%b格式指示符控制下的参数字符串中有效），而且，任何留在参数里的字符、任何接下来的参数以及任何留在格式字符串中的字符，都被忽略</li> <li>\f 换页（formfeed）</li> <li>\n 换行</li> <li>\r 回车（Carriage return）</li> <li>\t 水平制表符</li> <li>\v 垂直制表符</li> <li>\ 一个字面上的反斜杠字符</li> <li>\ddd 表示1到3位数八进制值的字符，仅在格式字符串中有效</li> <li>\0ddd 表示1到3位的八进制值字符</li></ul> <h3 id="在echo中转义换行符"><a href="#在echo中转义换行符" class="header-anchor">#</a> 在echo中转义换行符</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>echo -e &quot;包含转义序列的字符串&quot;
echo -e &quot;1\t2\t3&quot;
1 2 3
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="打印彩色输出"><a href="#打印彩色输出" class="header-anchor">#</a> 打印彩色输出</h3> <p><strong>文字色</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>echo -e &quot;\e[1;31mThis is red text\e[0m&quot;
This is red text
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>\e[1;31m 将颜色设置为红色</li> <li>\e[0m 将颜色重新置回</li></ul> <p>颜色码：重置=0，黑色=30，红色=31，绿色=32，黄色=33，蓝色=34，洋红=35，青色=36，白色=37</p> <p><strong>背景色</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>echo -e &quot;\e[1;42mGreed Background\e[0m&quot;
Greed Background
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>颜色码：重置=0，黑色=40，红色=41，绿色=42，黄色=43，蓝色=44，洋红=45，青色=46，白色=47</p> <p><strong>文字闪动</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>echo -e &quot;\033[37;31;5mMySQL Server Stop...\033[39;49;0m&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>红色数字处还有其他数字参数：<strong>0</strong> 关闭所有属性、<strong>1</strong> 设置高亮度（加粗）、<strong>4</strong> 下划线、<strong>5</strong> 闪烁、<strong>7</strong> 反显、<strong>8</strong> 消隐</p> <h2 id="算术运算"><a href="#算术运算" class="header-anchor">#</a> 算术运算</h2> <h3 id="整数运算"><a href="#整数运算" class="header-anchor">#</a> 整数运算</h3> <p><strong><a href="http://man.linuxde.net/let" target="_blank" rel="noopener noreferrer">let<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>运算命令</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/bin/bash
no1=2;
no2=3;
let result=no1+no2
echo $result
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>自加操作<code>let no++</code></li> <li>自减操作<code>let no--</code></li> <li>简写形式<code>let no+=10let no-=20</code>分别等同于<code>let no=no+10let no=no-20</code></li></ul> <p><strong>操作符[]运算方法</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/bin/bash
no1=2;
no2=3;
result=$[$no1+no2]
echo $result
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>使用方法和let相似，在<code>[]</code>中可以使<code>$</code>前缀。</p> <p><strong>(())运算方法</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/bin/bash
no1=2;
no2=3;
result=$((no1+no2))
echo $result
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong><a href="http://man.linuxde.net/expr" target="_blank" rel="noopener noreferrer">expr<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>运算方法</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>result=`expr 2 + 3`
result=$(expr $no1 + 5)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>expr的常用运算符</strong></p> <ul><li>加法运算：+</li> <li>减法运算：-</li> <li>乘法运算：*</li> <li>除法运算：/</li> <li>求摸（取余）运算：%</li></ul> <h3 id="精密计算"><a href="#精密计算" class="header-anchor">#</a> 精密计算</h3> <p>算术操作高级运算工具：<a href="http://man.linuxde.net/bc" target="_blank" rel="noopener noreferrer">bc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，它可以执行浮点运算和一些高级函数</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>echo &quot;1.212*3&quot; | bc 
3.636
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>设定小数精度（数值范围）</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>echo &quot;scale=2;3/8&quot; | bc
0.37
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>参数<strong>scale=2</strong>是将bc输出结果的小数位设置为2位。</p> <p><strong>进制转换</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/bin/bash
abc=192
echo &quot;obase=2;$abc&quot; | bc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>执行结果为：11000000，这是用bc将十进制转换成二进制。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/bin/bash
abc=11000000
echo &quot;obase=10;ibase=2;$abc&quot; | bc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>执行结果为：192，这是用bc将二进制转换为十进制。</p> <p><strong>计算平方和平方根</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>echo &quot;10^10&quot; | bc
echo &quot;sqrt(100)&quot; | bc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="常用变量"><a href="#常用变量" class="header-anchor">#</a> 常用变量</h2> <p>结合不同的引导为变量赋值</p> <ul><li>双引号 &quot;&quot; ：允许通过$符号引用其他变量值</li> <li>单引号 '' ：禁止引用其他变量值，$视为普通字符</li> <li>反撇号 `` ：将命令执行的结果输出给变量</li></ul> <h3 id="用户自定义变量"><a href="#用户自定义变量" class="header-anchor">#</a> 用户自定义变量</h3> <p>设置变量的作用范围</p> <p>格式：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>export 变量名...
export 变量名=变量值 [...变量名n=变量值n]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>清除用户自定义变量</p> <p>格式：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>unset 变量名
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="环境变量"><a href="#环境变量" class="header-anchor">#</a> 环境变量</h3> <p>环境变量配置文件</p> <ul><li>全局配置文件：/etc/profile</li> <li>用户配置文件：~/.bash_profile</li></ul> <p>查看环境变量</p> <p><a href="http://man.linuxde.net/set" target="_blank" rel="noopener noreferrer">set<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>命令可以查看所有的<a href="http://www.1987.name/shell" target="_blank" rel="noopener noreferrer">shell<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>变量，其中包括环境变量</p> <p>常见的环境变量</p> <ul><li>$USER 查看账户信息</li> <li>$<a href="http://man.linuxde.net/logname" target="_blank" rel="noopener noreferrer">logname<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 登录相关信息</li> <li>$UID</li> <li>$<a href="http://www.1987.name/shell" target="_blank" rel="noopener noreferrer">Shell<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>$HOME 家目录</li> <li>$<a href="http://man.linuxde.net/pwd" target="_blank" rel="noopener noreferrer">pwd<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>$PATH 用户所输入的命令是在哪些目录中查找</li> <li>$PS1</li> <li>$PS2</li> <li>$RANDOM 随机数</li></ul> <h3 id="位置变量"><a href="#位置变量" class="header-anchor">#</a> 位置变量</h3> <p>表示为：$n （n为1~9之间的数字）</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#./test.sh one two three four five six
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>$0 表示文件名本身</li> <li>one就是：$1</li> <li>two就是：$2</li></ul> <h3 id="预定义变量"><a href="#预定义变量" class="header-anchor">#</a> 预定义变量</h3> <ul><li>$# ：命令行中位置参数的个数</li> <li>$* ：所有位置参数的内容</li> <li>$? ：上一条命令执行后返回的状态，当返回状态值为0时表示执行正常，非0表示执行异常或出错</li> <li>$$ ：当前所在进程的进程号</li> <li>$! ：后台运行的最后一个进程号</li> <li>$0 ：当前执行的进程/程序名</li></ul> <h1 id="文件的描述符和重定向"><a href="#文件的描述符和重定向" class="header-anchor">#</a> 文件的描述符和重定向</h1> <p>文件描述符是和文件的输入、输出相关联的<strong>非负整数</strong>，Linux内核（kernel）利用文件描述符（<a href="http://man.linuxde.net/file" target="_blank" rel="noopener noreferrer">file<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> descriptor）来访问文件。打开现存文件或新建文件时，内核会返回一个文件描述符。读写文件也需要使用文件描述符来指定待读写的文件。常见的文件描述符是<strong>stdin</strong>、<strong>stdout</strong>和<strong>stderr</strong>。</p> <h3 id="系统预留文件描述符"><a href="#系统预留文件描述符" class="header-anchor">#</a> 系统预留文件描述符</h3> <ul><li><strong>0</strong> —— stdin（标准输入）</li> <li><strong>1</strong> —— stdout（标准输出）</li> <li><strong>2</strong> —— stderr（标准错误）</li></ul> <p>重定向将输入文本<strong>通过截取模式</strong>保存到文件：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>echo &quot;this is a text line one&quot; &gt; test.txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>写入到文件之前，文件内容首先会被清空。</p> <p>重定向将输入文本<strong>通过追加模式</strong>保存到文件：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>echo &quot;this is a text line one&quot; &gt;&gt; test.txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>写入到文件之后，会追加到文件结尾。</p> <p><strong>标准错误输出：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@localhost text]# cat linuxde.net
cat: linuxde.net: No such file or directory
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>标准错误输出的重定向方法：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>方法一：
[root@localhost text]# cat linuxde.net 2&gt; out.txt  //没有任何错误提示，正常运行。
方法二：
[root@localhost text]# cat linuxde.net &amp;&gt; out.txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>因为错误信息被保存到了out.txt文件中。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@localhost text]# cat linuxde.net 2&gt; /dev/null
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>将错误输出丢弃到<code>/dev/null</code>中，/dev/null是一个特殊的设备文件，这个文件接受到任何数据都会被丢系，通常被称为位桶、黑洞。</p> <h3 id="tee命令"><a href="#tee命令" class="header-anchor">#</a> tee命令</h3> <p>tee命令可以将数据重定向到文件，另一方面还可以提供一份重定向数据的副本作为后续命令的stdin。</p> <p><img src="https://image.aomtop.com/i/2022/06/13/62a6e32de3cf4.png" alt="文件的描述符和重定向"></p> <p>在终端打印stdout同时重定向到文件中：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ls | tee out.txt
1.sh
1.txt
2.txt
eee.tst
EEE.tst
one
out.txt
string2
www.pdf
WWW.pdf
WWW.pef
[root@localhost text]# ls | tee out.txt | cat -n
     1  1.sh
     2  1.txt
     3  2.txt
     4  eee.tst
     5  EEE.tst
     6  one
     7  out.txt
     8  string2
     9  www.pdf
    10  WWW.pdf
    11  WWW.pef
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="重定向脚本内的文本片段-多行文本"><a href="#重定向脚本内的文本片段-多行文本" class="header-anchor">#</a> 重定向脚本内的文本片段（多行文本）</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/bin/bash
cat &lt;&lt;EOF&gt;text.log
this is a text line1
this is a text line2
this is a text line3
EOF
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>在<code>cat &lt;&lt;EOF&gt;text.log</code>与下一个<code>EOF</code>行之间的所有文本都会当作stdin数据输入到text.log中。</p> <h3 id="自定义文件描述符"><a href="#自定义文件描述符" class="header-anchor">#</a> 自定义文件描述符</h3> <p>除了0、1和2分别是<strong>stdin</strong>、<strong>stdout</strong>和<strong>stderr</strong>的系统预留描述符，我们还可以使用<code>exec命令</code>创建自定义文件描述符，文件的的打开模式有<strong>只读模式</strong>、<strong>截断模式</strong>和<strong>追加模式</strong>。</p> <p><strong>&lt; 操作符用于从文件中读取至stdin：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>echo this is a test line &gt; input.txt
exec 3&lt;input.txt    //自定义文件描述符3打开并读取文件
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>在命令中使用文件描述符3：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cat &lt;&amp;3
this is a test line
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>这里需要注意只能读取一次，如果再次使用需要重新创建文件描述符。</p> <p><strong>&gt; 操作符用于截断模式的文件写入（数据在文件内容被截断之后写入）：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>exec 4&gt;output.txt
echo this is a new line &gt;&amp;4
cat output.txt
this is a new line
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>&gt;&gt; 操作符用于追加模式的文件写入（添加数据到文件中，原有数据不会丢失）：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>exec 5&gt;&gt;output.txt
echo this is a appended line &gt;&amp;5
cat output.txt
this is a new line
this is a appended lin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h1 id="数组、关联数组和别名使用"><a href="#数组、关联数组和别名使用" class="header-anchor">#</a> 数组、关联数组和别名使用</h1> <p><strong>数组</strong>作为一种特殊的数据结构在任何一种编程语言中都有它的一席之地，数组在Shell脚本中也是非常重要的组成部分，它借助索引将多个独立的数据存储为一个集合。</p> <h3 id="数组"><a href="#数组" class="header-anchor">#</a> 数组</h3> <p>普通数组只能使用整数作为数组的索引值。</p> <p><strong>定义数组</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>格式：array[key]=value
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>单行一列值：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>array_pt=( 1 2 3 4 5 6 )
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>一组索引值：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>array_pt[0]=&quot;text1&quot;
array_pt[1]=&quot;text2&quot;
array_pt[2]=&quot;text3&quot;
array_pt[3]=&quot;text4&quot;
array_pt[4]=&quot;text5&quot;
array_pt[5]=&quot;text6&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>打印数组</strong></p> <p>打印指定索引的数组元素内容：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#echo ${array_pt[0]}
text1
index=3
#echo ${array_pt[$index]}
text4
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>打印数组中的所有值：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#echo ${array_pt[*]}
或者
#echo ${array_pt[@]}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>打印数组长度（即数组中元素的个数）：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#echo ${#array_pt[*]}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>删除数组：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>unset array_pt[1]  //删除数组中第一个元素
unset array_pt     //删除整个数组
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>数组的提取：</strong></p> <p>例如定义了数组 array=( [0]=one [1]=two [2]=three [3]=four )</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>${array[@]:0}    //除去所有元素
${array[@]:1}    //出去第一个元素后的所有元素
#echo ${array[@]:0:2}
one two
#echo ${array[@]:1:2}
two three
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>子串删除：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#echo ${array[@]:0}
one two three four
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>左边开始最短的匹配<code>:&quot;t*e&quot;</code>，这将匹配到<code>&quot;thre&quot;</code></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#echo ${array[@]#t*e}
one two e four
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>左边开始最长的匹配，这将匹配到<code>&quot;three&quot;</code></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#echo ${array[@]##t*e}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>从字符串的结尾开始最短的匹配</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#echo ${array[@]%o}
one tw three four
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>从字符串的结尾开始最长的匹配</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># echo ${array[@]%%o}
one tw three four
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>子串替换：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#echo ${array[@]/o/m}
mne twm three fmur
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>没有指定替换子串，则删除匹配到的子符</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#echo ${array[@]//o/}
ne tw three fur
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>替换字符串前端子串</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#echo ${array[@]/#o/k}
kne two three four
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>替换字符串后端子串</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#echo ${array[@]/%o/k}
one twk three four
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="关联数组"><a href="#关联数组" class="header-anchor">#</a> 关联数组</h3> <p><strong>关联数组</strong>从bash 4.0开始被引入，关联数组的索引值可以使用任意的文本。关联数组在很多操作中很有用。</p> <p><strong>关联数组的声明：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>declare -A array_var
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>使用内嵌索引-值列表法将元素添加到关联数组：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>array_var=( [one]=one-1 [two]=two-2 [three]=three-3 [four]=four-4 [five]=five-5 [six]=six-6 )
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>使用独立的索引-值进行赋值：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>array_var[one]=one-1
array_var[two]=two-2
array_var[three]=three-3
array_var[four]=four-4
array_var[five]=five-5
array_var[six]=six-6
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>关联数组的打印方法跟普通数组用法一样。</p> <p><strong>列出数组索引值：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#echo ${!array_var[*]}
four one five six two three
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>列出索引值的方法也可以用在普通数组上。</p> <h3 id="别名"><a href="#别名" class="header-anchor">#</a> 别名</h3> <p><strong>别名</strong>就是提供一种便捷的方式来完成某些长串命令的操作。省去不必要的麻烦，提高效率。一般可以是函数或者<code>alias命令</code>来实现。</p> <p><strong>alias举例</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>alias nginxrestart='/usr/local/webserver/nginx/sbin/nginx -s reload'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这样设置之后以后可以使用nginxrestart这个命令来代替<code>/usr/local/webserver/nginx/sbin/nginx -s reload</code>了。这样设置重启之后就会失效，所以需要将它放入<code>~/.bashrc</code>文件中。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>echo 'alias nginxrestart=&quot;/usr/local/webserver/nginx/sbin/nginx -s reload&quot;' &gt;&gt; ~/.bashrc 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>查看系统已经定义的别名</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@mail text]# alias 
alias cp='cp -i'
alias l.='ls -d .* --color=tty'
alias ll='ls -l --color=tty'
alias ls='ls --color=tty'
alias mv='mv -i'
alias rm='rm -i'
alias vi='vim'
alias which='alias | /usr/bin/which --tty-only --read-alias --show-dot --show-tilde'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>别名转义</strong></p> <p>有些命令不是总是希望使用别名，可以在命令之前输入反斜杠<code>\</code>来忽略所定义过的别名。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#\command
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h1 id="shell函数的定义、执行、传参和递归函数"><a href="#shell函数的定义、执行、传参和递归函数" class="header-anchor">#</a> Shell函数的定义、执行、传参和递归函数</h1> <p>Bash（Bourne Again shell）也跟其他编程语言一样也支持函数，一般在编写大型脚本中需要用到，它可以将shell脚本程序划分成一个个功能相对独立的代码块，使代码的模块化更好，结构更加清晰，并可以有效地减少程序的代码量。但是bash作为一种解释性语言，bash 在编程能力方面提供的支持并不像其他编译性的语言（例如 C 语言）那样完善，执行效率也会低很多。</p> <h3 id="shell函数的定义、执行与传参"><a href="#shell函数的定义、执行与传参" class="header-anchor">#</a> shell函数的定义、执行与传参</h3> <p><strong>定义</strong></p> <p>格式1</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>function name() {
 command sequence(命令序列);
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>格式2</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>name() {
 Command sequence(命令序列);
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>可以带<code>function name()</code>定义，也可以直接<code>name()</code>定义，不带任何参数。</p> <p><strong>执行</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>name;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>直接使用函数名称即可调用某个函数。</p> <p><strong>传递参数</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/bin/bash
aa=&quot;this is aa&quot;
bb=&quot;this is bb&quot;
function name() {                  #定义函数name
        local cc=&quot;this is cc&quot;      #定义局部变量$cc
        local dd=&quot;this is dd&quot;      #定义局部变量$dd
        echo $aa, $bb              #访问参数1和参数2
        echo $cc                   #打印局部变量
        return 0                   #shell函数返回值是整形，并且在0~257之间。
}

echo $dd                           #这里将会打印不生效，因为dd是局部变量。
name                               #使用函数name
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>上例中：</p> <ul><li>aa 和 bb 定义的是全局变量。</li> <li>cc 和 dd 定义的是局部变量，只能在函数 name 中使用。</li> <li><code>$aa</code>是第一个参数<code>$1</code>，<code>$bb</code>是第一个参数<code>$2</code>，以此类推<code>$n</code>是第n个参数<code>$n</code>。</li> <li><code>return 0</code>参数返回，可以显示加：<code>return 返回</code>，如果不加，将以最后一条命令运行结果作为返回值。</li></ul> <h3 id="递归函数"><a href="#递归函数" class="header-anchor">#</a> 递归函数</h3> <p>bash也支持递归函数（能够调用自身的函数）例如：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/bin/bash

function name() {
        echo $1
        name hello
        sleep 1
}
name
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>运行此脚本后不断打印出hello，按<code>Ctrl+C</code>结束。</p> <p><strong>递归经典：fork 炸弹</strong></p> <p>可能很多人都曾经听说过 fork 炸弹，它实际上只是一个非常简单的递归程序，程序所做的事情只有一样：这个递归函数能够调用自身，不算的生成新的进程，这会导致这个简单的程序迅速耗尽系统里面的所有资源，造成拒绝服务攻击。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>.()
{
.|.&amp;
}
;
.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>第 1 行说明下面要定义一个函数，函数名为小数点，没有可选参数。</li> <li>第 2 行表示函数体开始。</li> <li>第 3 行是函数体真正要做的事情，首先它递归调用本函数，然后利用管道调用一个新进程（它要做的事情也是递归调用本函数），并将其放到后台执行。</li> <li>第 4 行表示函数体结束。</li> <li>第 5 行并不会执行什么操作，在命令行中用来分隔两个命令用。从总体来看，它表明这段程序包含两个部分，首先定义了一个函数，然后调用这个函数。</li> <li>第 6 行表示调用本函数。</li></ul> <h1 id="条件测试操作与流程控制语句"><a href="#条件测试操作与流程控制语句" class="header-anchor">#</a> 条件测试操作与流程控制语句</h1> <p>在编写Shell脚本时候，经常需要判断两个字符串是否相等，检查文件状态或者是数字的测试等。Shell提供了对字符串、文件、数值等内容的条件测试以及逻辑流程控制。</p> <h2 id="条件测试操作"><a href="#条件测试操作" class="header-anchor">#</a> 条件测试操作</h2> <p>程序中的流程控制是由比较和测试语句来处理的，bash具备多种与UNIX系统级特性相兼容的执行测试方法。</p> <h3 id="常用测试操作"><a href="#常用测试操作" class="header-anchor">#</a> 常用测试操作</h3> <p><code>test</code>命令，测试特定的表达式是否成立，当条件成立时，命令执行后的返回值为0，否则为其他数值。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>格式1
test 条件表达式
格式2
[ 条件表达式 ]       //常用格式，使用方括号时，要注意在条件两边加上空格。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>常见测试类型</p> <ul><li>测试文件状态</li> <li>字符串的比较</li> <li>整数值的比较</li> <li>逻辑测试</li></ul> <h3 id="测试文件"><a href="#测试文件" class="header-anchor">#</a> 测试文件</h3> <table><thead><tr><th>常用的文件测试操作符</th> <th>说明</th></tr></thead> <tbody><tr><td>-d 文件,d的全称是directory</td> <td>文件存在且为目录则为真</td></tr> <tr><td>-f 文件,f的全称是file</td> <td>文件存在且为普通文件则为真</td></tr> <tr><td>-e 文件,e的全称是exist</td> <td>文件存在则为真，-e不辨别是文件还是目录</td></tr> <tr><td>-r 文件,r的全称是read</td> <td>文件存在且可读，则为真</td></tr> <tr><td>-s 文件,s的全称是size</td> <td>文件存在且文件大小不为0，则为真</td></tr> <tr><td>-w 文件,w的全称是write</td> <td>文件存在且可写，则为真</td></tr> <tr><td>-x 文件,x的全称是executable</td> <td>文件存在且可执行，则为真</td></tr> <tr><td>-L 文件,L的全称是Link</td> <td>文件存在且为链接文件，则为真</td></tr> <tr><td>f1 -nt f2,nt的全称是newer than</td> <td>文件f1比文件f2新,则为真;根据文件修改时间对比</td></tr> <tr><td>f1 -ot f2,nt的全称是older than</td> <td>文件f1比文件f2旧,则为真;根据文件修改时间对比</td></tr></tbody></table> <p>如果需要获取更多信息，则使用<code>man test</code></p> <p>操作符：</p> <ul><li>-d：测试是否为目录，是则为真（Directory）</li> <li>-e：测试目录或文件是否存在，存在则为真（Exist）</li> <li>-f：测试是否为文件，是则为真（<a href="http://man.linuxde.net/file" target="_blank" rel="noopener noreferrer">file<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）</li> <li>-r：测试当前用户是否有权限读取，是则为真（<a href="http://man.linuxde.net/read" target="_blank" rel="noopener noreferrer">read<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）</li> <li>-<a href="http://man.linuxde.net/w" target="_blank" rel="noopener noreferrer">w<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：测试当前用户是否有权限写入，是这为真（<a href="http://man.linuxde.net/write" target="_blank" rel="noopener noreferrer">write<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）</li> <li>-x：测试当前用户是否可执行该文件，可执行则为真（Excute）</li> <li>-L：测试是否为符号链接文件，是则为真（Link）</li> <li>-nt：file1 -nt file2 如果 file1 比 file2 新（修改时间），则为真</li> <li>-ot：file1 -ot file2 如果 file1 比 file2 旧（修改时间），则为真</li></ul> <h3 id="字符串比较"><a href="#字符串比较" class="header-anchor">#</a> 字符串比较</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>格式
[ 字符串1 = 字符串2 ]
[ 字符串1 != 字符串2 ]
[ -z 字符串 ]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>操作符：</p> <ul><li>=：字符串内容相同则为真，就是说包含的文本一摸一样。</li> <li>!=：字符串内容不同，则为真（!号表示相反的意思）</li> <li>-z：字符串内容为空（长度为零）则为真</li> <li>-n：字符串内容非空（长度非零）则为真</li> <li>&lt;：string1 &lt; string2 如果string1在本地的字典序列中排在string2之前，则为真</li> <li>&gt;：string2 如果string1在本地的字典序列中排在string2之后，则为真</li></ul> <p>注意点：</p> <p>1、字符串的 “等于” 比较，为了与<a href="http://zh.wikipedia.org/wiki/POSIX" target="_blank" rel="noopener noreferrer">POSIX<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>一致，在<code>[]</code>中使用<code>=</code>，（尽管<code>==</code>也可以可以用的）
2、注意在<code>=</code>前后各有一个空格，如果没有空格就是赋值的关系，不是比较的关系。
3、字符串的<code>&gt; &lt;</code>比较运算符，一般放在<code>[[ ]]</code>之中，而不是<code>test (&quot;[]&quot;)</code>
4、字符串的<code>&gt; &lt;</code>比较的结果，与本地的locale有关，是按照其字典序列进行比较的</p> <h3 id="整数值比较"><a href="#整数值比较" class="header-anchor">#</a> 整数值比较</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>格式
[ 整数1 操作符 整数2 ]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>-eq：等于（equal）</li> <li>-ne：不等于（not equal）</li> <li>-gt：大于（Greater than）</li> <li>-lt：小于（lesser than）</li> <li>-le：小于等于（lesser or equal）</li> <li>-ge：大于等于（Greater or equal）</li></ul> <h3 id="逻辑测试"><a href="#逻辑测试" class="header-anchor">#</a> 逻辑测试</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>格式
[ 表达式1 ] 操作符 [ 表达式2 ] ...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>操作符</p> <ul><li>-a 或 &amp;&amp; ：逻辑与，“而且”的意思，前后两个表达式都成立时整个测试结果才为真，否则为假</li> <li>-o 或 || ： 逻辑或，“或者”的意思，操作符两边至少一个为真时，结果为真，否为为假</li> <li>! ：逻辑否，当制定条件不成立时，返回结果为真</li></ul> <h2 id="流程控制语句"><a href="#流程控制语句" class="header-anchor">#</a> 流程控制语句</h2> <p>Shell有一套自己的流程控制语句，其中包括条件语句、循环语句、选择语句等。</p> <h3 id="if条件语句"><a href="#if条件语句" class="header-anchor">#</a> if条件语句</h3> <p><strong>if 单分支</strong>：当“条件成立”时执行相应的操作。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>if 条件测试操作
  then 命令序列
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="https://image.aomtop.com/i/2022/06/13/62a6e32e1dbf6.png" alt="if单分支">
if 单分支结构流程图</p> <p>示例</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/bin/bash
#当/boot分区的空间使用超过80%，就输出报警信息。

use=`df -hT | grep &quot;/boot&quot; | awk '{print $6}' | cut -d &quot;%&quot; -f1`
if [ $use -gt 80 ];
  then
    echo &quot;Warning!!/boot disk is full&quot;
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>if 双分支</strong>：当“条件成立”、“条件不成立”时执行不同操作。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>if 条件测试命令
  then 命令序列1
  else 命令序列2
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="https://image.aomtop.com/i/2022/06/13/62a6e32e473a2.png" alt="if双分支">
if 双分支结构流程图</p> <p>示例</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/bin/bash
#判断iptables是否在运行，如果已经在运行提示信息，如果没有开启它。
service iptables status &amp;&gt; /dev/null
if [ $? -eq 0 ];
  then
    echo &quot;iptables service is running&quot;
  else
    service iptables restart
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>if 多分支</strong>：相当于if语句嵌套，针对多个条件执行不同操作。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>if 条件测试命令1 ; then
 命令序列1
elif 条件测试命令2 ; then
 命令序列2
elif ...
else
 命令序列n
fi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><img src="https://image.aomtop.com/i/2022/06/13/62a6e32e71706.png" alt="if多分支">
if多分支结构流程图</p> <h3 id="for循环语句"><a href="#for循环语句" class="header-anchor">#</a> for循环语句</h3> <p>根据标量的不同取值，重复执行一组命令操作。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>for 变量名 in 取值列表
do
 命令序列
done
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="https://image.aomtop.com/i/2022/06/13/62a6e32e9ec86.png" alt="for循环">
for循环语句流程图</p> <p><strong>for循环的几种应用形式：</strong></p> <p>最基本的for循环： （传统的形式，for var in …)</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/bin/bash
for x in one two three four
do
    echo number $x
done 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><code>for</code>循环总是接收<code>in</code>语句之后的某种类型的字列表。在本例中，指定了四个英语单词，但是字列表也可以引用磁盘上的文件，甚至文件通配符。</p> <p>对目录中的文件做for循环</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/bin/bash
for x in /var/log/*
do
   #echo &quot;$x is a file living in /var/log&quot;
   echo $(basename $x) is a file living in /var/log
done 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>这个<code>$x</code>获得的是绝对路径文件名，可以使用<code>basename</code>可执行程序来除去前面的路径信息。如果只引用当前工作目录中的文件（例如如果输入<code>for x in *</code>），则产生的文件列表将没有路径信息的前缀。</p> <p>对位置参数做for循环</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/bin/bash
for thing in &quot;$@&quot;
do
   echo you typed ${thing}.
done 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>for循环中用<code>seq</code>产生循环次数，加上C语言形式的for循环语句</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/bin/bash
echo &quot;for: Traditional form: for var in ...&quot;
for j in $(seq 1 5)
do
  echo $j
done
echo &quot;for: C language form: for (( exp1; exp2; exp3 ))&quot;
for (( i=1; i&lt;=5; i++ ))
do
  echo &quot;i=$i&quot;
done 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>对于固定次数的循环，可以通过<code>seq</code>命令来实现，就不需要变量的自增了，这里的C语言for循环风格是挺熟悉的吧。</p> <h3 id="while循环语句"><a href="#while循环语句" class="header-anchor">#</a> while循环语句</h3> <p>重复测试指令的条件，只要条件为真则反复执行对应的命令操作，直到条件为假。如果使用<code>true</code>作为循环条件能够产生无限循环。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>while 命令表达式
do
  命令列表
done
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="https://image.aomtop.com/i/2022/06/13/62a6e32ec9bf6.png" alt="while循环">
while循环流程图</p> <p>示例</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/bin/bash
#批量添加20个系统账户用户名依次为user1~20
i=1
while [ $i -le 20 ]
do
 useradd user$1
 echo &quot;123456&quot; | passwd --stdin user$i &amp;&gt; /dev/null
 i=`expr $i + 1`
done
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>只要特定条件为真，”while” 语句就会循环执行。</p> <h3 id="case多重分支语句"><a href="#case多重分支语句" class="header-anchor">#</a> case多重分支语句</h3> <p>根据变量的不通取值，分别执行不同的命令操作。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>case 变量值 in
 模式1)
 命令序列1
;;
 模式2)
 命令序列2
;;
 ……
*)
 默认执行的命令序列
;;
esac
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><img src="https://image.aomtop.com/i/2022/06/13/62a6e32f015eb.png" alt="case循环">
case多重分支语句流程图</p> <p>示例</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/bin/bash
case $1 in
start)
  echo &quot;start mysql&quot;
;;
stop)
  echo &quot;stop mysql&quot;
;;
*)
  echo &quot;usage: $0 start|stop&quot;
;;
esac
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="until循环语句"><a href="#until循环语句" class="header-anchor">#</a> until循环语句</h3> <p>根据条件执行重复操作，直到条件成立为止。<code>Until</code>语句提供了与<code>while</code>语句相反的功能：只要特定条件为假，它们就重复循环，直到条件为真。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>until 条件测试命令
do
 命令序列
done
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="https://image.aomtop.com/i/2022/06/13/62a6e32f2f405.png" alt="until循环">
until循环流程图</p> <p>示例</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/bin/bash
myvar=1
until [ $myvar -gt 10 ]
do
 echo $myvar
 myvar=$(( $myvar + 1 ))
done 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="shift迁移语句"><a href="#shift迁移语句" class="header-anchor">#</a> shift迁移语句</h3> <p>用于迁移位置变量，将<code>$1~$9</code>依次向左传递。</p> <p>例如：若当前脚本程序获得的位置变量如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$1=file1、$2=file2、$3=file3、$4=file4
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>执行一次shift命令后，各位置变量为：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$2=file2、$3=file3、$4=file4
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在执行一次：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$3=file3、$4=file4
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>示例</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/bin/bash
res=0
while [ $# -gt 0 ]
do
 res=`expr $res + $1`
 shift
done
echo &quot;the sum is:$res&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="循环控制语句"><a href="#循环控制语句" class="header-anchor">#</a> 循环控制语句</h3> <p><strong>break语句</strong>：在<code>for、while、until</code>等循环语句中，用于跳出当前所在的循环体，执行循环体之后的语句。</p> <p>在while中的示例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>while
 do
commands
commands

 break--------+
              |
commands      |
commands      | 跳出当前循环（通常在循环体中与条件语句一起使用）
              |
 done         |
              |
commands&lt;-----+
commands
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><strong>continue语句</strong>：在<code>for、while、until</code>等循环语句中，用于跳过循环体内余下的语句，重新判断条件以便执行下一次循环。</p> <p>在while中的示例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>while&lt;-------+
 do          |
             |
commands     | 跳回当前循环，重新开始下一次循环（通常在循环体中与条件语句一起使用）
commands     |
             |
 continue----+

commands
commands
commands
 done
commands
commands
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h1 id="内部字段分隔符ifs、脚本调试debug"><a href="#内部字段分隔符ifs、脚本调试debug" class="header-anchor">#</a> 内部字段分隔符IFS、脚本调试DEBUG</h1> <h3 id="内部字段分隔符"><a href="#内部字段分隔符" class="header-anchor">#</a> 内部字段分隔符</h3> <p>**内部字段分隔符(Internal Field Separator, IFS)**是shell脚本中的一个特殊变量，在处理文本数据很有用。把单个数据流划分成不同的数据元素的定界符，内部字段分隔符就是用于特定用途的定界符。IFS是存储定界符的环境变量，是shell环境中的默认定界符字符串，默认值为空白字符（换行符、制表符、空格）</p> <p>迭代一个字符串或者<a href="http://zh.wikipedia.org/wiki/CSV" target="_blank" rel="noopener noreferrer">CSV<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>（Comma Separated Value, 逗号分隔型数值）中的单词：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/bin/bash

data=&quot;111,222,333,444,555,666&quot;

oldIFS=$IFS  #定义一个变量为默认IFS
IFS=,        #设置IFS为逗号

for i in $data
do
 echo S:$i
done

IFS=$oldIFS  #还原IFS为默认值
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>执行结果：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@mail text]# ./6.sh
S:111
S:222
S:333
S:444
S:555
S:666
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>IFS被设置为逗号（,），shell将逗号解释为一个定界符，因此变量$i在每次迭代中读取由逗号分隔的字符串作为变量值。</p> <h3 id="shell脚本的调试"><a href="#shell脚本的调试" class="header-anchor">#</a> Shell脚本的调试</h3> <p>调式功能是每种编程语言都具备的特性之一，出现一些始料未及的情况，使用调式功能可以弄清楚是什么原因发生了错误或者异常。shell脚本自身已经包含了调式选项，能都打印出脚本接受的参数和输入。</p> <p><strong>1、使用选项 -x</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>bash -x script.sh

或者

sh -x script.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>-x 选项是打印所有行的信息。</p> <p><strong>2、使用 <a href="http://man.linuxde.net/set" target="_blank" rel="noopener noreferrer">set<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> +/-x ;set +/-v</strong></p> <ul><li>set -x：在执行时候显示参数和命令。</li> <li>set +x：禁止调式。</li> <li>set -v：当命令进入读取时候显示输入。</li> <li>set +v：禁止打印输入。</li></ul> <p>示例</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/bin/bash

for i in {1..5}
do
set -x
 echo $i
set +x
done

echo &quot;end&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>上例中，仅在 -x 和 +x 的区域中才会显示调式信息。</p> <p><strong>3、使用 _DEBUG 环境变量</strong></p> <p>如果需要自定义格式显示调式信息可以通过_DEBUG环境变量来建立：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/bin/bash

DEBUG() {
[ &quot;$_DEBUG&quot; = &quot;on&quot; ] &amp;&amp; $@ || :
}

for i in {1..5}
do
DEBUG echo $i
done
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>将调试功能设置为“on”来运行脚本：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>_DEBUG=on ./script.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>将需要调式的行前加上DEBUG，运行脚本前没有加_DEBUG=on就不会显示任何信息，脚本中“:”告诉shell不要进行任何操作。</p> <p><strong>4、使用shebang调式方法</strong></p> <p>这是最便捷的方法。把shebang 从#!/bin/bash 修改成 #!/bin/bash -xv ，其他就不用做任何操作了。</p> <h1 id="切分文件名提取文件扩展名或提取文件名"><a href="#切分文件名提取文件扩展名或提取文件名" class="header-anchor">#</a> 切分文件名提取文件扩展名或提取文件名</h1> <p>有些脚本要根据文件名进行各种处理，有时候需要保留文件名抛弃文件后缀，也有时候需要文件后缀不要文件名，这类提取文件部分的操作使用shell的内建功能就能实现。需要用到的几个操作符有：<strong>%</strong>、<strong>%%</strong>、<strong>#</strong>、<strong>##</strong>。</p> <p><strong>从右向左匹配 ：</strong>% 和 %% 操作符的示例</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/bin/bash
#提取文件名，删除后缀。

file_name=&quot;text.gif&quot;
name=${file_name%.*}
echo file name is: $name

输出结果：
file name is: test

# ${VAR%.* }含义：从$VAR中删除位于 % 右侧的通配符左右匹配的字符串，通配符从右向左进行匹配。现在给变量 name 赋值，name=text.gif，那么通配符从右向左就会匹配到 .gif，所有从 $VAR 中删除匹配结果。
# % 属于非贪婪操作符，他是从左右向左匹配最短结果；%% 属于贪婪操作符，会从右向左匹配符合条件的最长字符串。

file_name=&quot;text.gif.bak.2012&quot;
name=${file_name%.*}
name2=${file_name%%.*}
echo file name is: $name
echo file name is: $name2

输出结果：
file name is: test.gif.bak    //使用 %
file name is: test            //使用 %%

操作符 %% 使用 .* 从右向左贪婪匹配到 .gif.bak.2012
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p><strong>从左向右匹配：</strong># 和 ## 操作符示例</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/bin/bash
#提取后缀，删除文件名。

file_name=&quot;text.gif&quot;
suffix=${file_name#*.}
echo suffix is: $suffix

输出结果：
suffix is: gif

# ${VAR#*.} 含义：从 $VAR 中删除位于 # 右侧的通配符所匹配的字符串，通配符是左向右进行匹配。
# 跟 % 一样，# 也有贪婪操作符 ## 。

file_name=&quot;text.gif.bak.2012.txt&quot;
suffix=${file_name#*.}
suffix2=${file_name##*.}
echo suffix is: $suffix
echo suffix is: $suffix2

输出结果：
suffix is: text.gif.bak.2012     //使用 #
suffix2 is: txt                  //使用 ##

操作符 ## 使用 *. 从左向右贪婪匹配到 text.gif.bak.2012
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p><strong>示例2，定义变量 url=&quot;<a href="http://man.linuxde.net/man" target="_blank" rel="noopener noreferrer">man<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.linuxde.net&quot;</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>echo ${url%.*}      #移除 .* 所匹配的最右边的内容。
man.linuxde
echo ${url%%.*}     #将从右边开始一直匹配到最左边的 *. 移除，贪婪操作符。
man
echo ${url#*.}      #移除 *. 所有匹配的最左边的内容。
linuxde.net
echo ${url##*.}     #将从左边开始一直匹配到最右边的 *. 移除，贪婪操作符。
net
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h1 id="find命令"><a href="#find命令" class="header-anchor">#</a> find命令</h1> <p><strong>find命令</strong>用来在指定目录下查找文件。任何位于参数之前的字符串都将被视为欲查找的目录名。如果使用该命令时，不设置任何参数，则find命令将在当前目录下查找子目录与文件。并且将查找到的子目录和文件全部进行显示。</p> <h3 id="语法"><a href="#语法" class="header-anchor">#</a> 语法</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>find(选项)(参数)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="选项"><a href="#选项" class="header-anchor">#</a> 选项</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>-amin&lt;分钟&gt;：查找在指定时间曾被存取过的文件或目录，单位以分钟计算；
-anewer&lt;参考文件或目录&gt;：查找其存取时间较指定文件或目录的存取时间更接近现在的文件或目录；
-atime&lt;24小时数&gt;：查找在指定时间曾被存取过的文件或目录，单位以24小时计算；
-cmin&lt;分钟&gt;：查找在指定时间之时被更改过的文件或目录；
-cnewer&lt;参考文件或目录&gt;查找其更改时间较指定文件或目录的更改时间更接近现在的文件或目录；
-ctime&lt;24小时数&gt;：查找在指定时间之时被更改的文件或目录，单位以24小时计算；
-daystart：从本日开始计算时间；
-depth：从指定目录下最深层的子目录开始查找；
-empty：寻找文件大小为0 Byte的文件，或目录下没有任何子目录或文件的空目录；
-exec&lt;执行指令&gt;：假设find指令的回传值为True，就执行该指令；
-false：将find指令的回传值皆设为False；
-fls&lt;列表文件&gt;：此参数的效果和指定“-ls”参数类似，但会把结果保存为指定的列表文件；
-follow：排除符号连接；
-fprint&lt;列表文件&gt;：此参数的效果和指定“-print”参数类似，但会把结果保存成指定的列表文件；
-fprint0&lt;列表文件&gt;：此参数的效果和指定“-print0”参数类似，但会把结果保存成指定的列表文件；
-fprintf&lt;列表文件&gt;&lt;输出格式&gt;：此参数的效果和指定“-printf”参数类似，但会把结果保存成指定的列表文件；
-fstype&lt;文件系统类型&gt;：只寻找该文件系统类型下的文件或目录；
-gid&lt;群组识别码&gt;：查找符合指定之群组识别码的文件或目录；
-group&lt;群组名称&gt;：查找符合指定之群组名称的文件或目录；
-help或——help：在线帮助；
-ilname&lt;范本样式&gt;：此参数的效果和指定“-lname”参数类似，但忽略字符大小写的差别；
-iname&lt;范本样式&gt;：此参数的效果和指定“-name”参数类似，但忽略字符大小写的差别；
-inum&lt;inode编号&gt;：查找符合指定的inode编号的文件或目录；
-ipath&lt;范本样式&gt;：此参数的效果和指定“-path”参数类似，但忽略字符大小写的差别；
-iregex&lt;范本样式&gt;：此参数的效果和指定“-regexe”参数类似，但忽略字符大小写的差别；
-links&lt;连接数目&gt;：查找符合指定的硬连接数目的文件或目录；
-iname&lt;范本样式&gt;：指定字符串作为寻找符号连接的范本样式；
-ls：假设find指令的回传值为Ture，就将文件或目录名称列出到标准输出；
-maxdepth&lt;目录层级&gt;：设置最大目录层级；
-mindepth&lt;目录层级&gt;：设置最小目录层级；
-mmin&lt;分钟&gt;：查找在指定时间曾被更改过的文件或目录，单位以分钟计算；
-mount：此参数的效果和指定“-xdev”相同；
-mtime&lt;24小时数&gt;：查找在指定时间曾被更改过的文件或目录，单位以24小时计算；
-name&lt;范本样式&gt;：指定字符串作为寻找文件或目录的范本样式；
-newer&lt;参考文件或目录&gt;：查找其更改时间较指定文件或目录的更改时间更接近现在的文件或目录；
-nogroup：找出不属于本地主机群组识别码的文件或目录；
-noleaf：不去考虑目录至少需拥有两个硬连接存在；
-nouser：找出不属于本地主机用户识别码的文件或目录；
-ok&lt;执行指令&gt;：此参数的效果和指定“-exec”类似，但在执行指令之前会先询问用户，若回答“y”或“Y”，则放弃执行命令；
-path&lt;范本样式&gt;：指定字符串作为寻找目录的范本样式；
-perm&lt;权限数值&gt;：查找符合指定的权限数值的文件或目录；
-print：假设find指令的回传值为Ture，就将文件或目录名称列出到标准输出。格式为每列一个名称，每个名称前皆有“./”字符串；
-print0：假设find指令的回传值为Ture，就将文件或目录名称列出到标准输出。格式为全部的名称皆在同一行；
-printf&lt;输出格式&gt;：假设find指令的回传值为Ture，就将文件或目录名称列出到标准输出。格式可以自行指定；
-prune：不寻找字符串作为寻找文件或目录的范本样式;
-regex&lt;范本样式&gt;：指定字符串作为寻找文件或目录的范本样式；
-size&lt;文件大小&gt;：查找符合指定的文件大小的文件；
-true：将find指令的回传值皆设为True；
-type&lt;文件类型&gt;：只寻找符合指定的文件类型的文件；
-uid&lt;用户识别码&gt;：查找符合指定的用户识别码的文件或目录；
-used&lt;日数&gt;：查找文件或目录被更改之后在指定时间曾被存取过的文件或目录，单位以日计算；
-user&lt;拥有者名称&gt;：查找符和指定的拥有者名称的文件或目录；
-version或——version：显示版本信息；
-xdev：将范围局限在先行的文件系统中；
-xtype&lt;文件类型&gt;：此参数的效果和指定“-type”参数类似，差别在于它针对符号连接检查。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><h3 id="参数"><a href="#参数" class="header-anchor">#</a> 参数</h3> <p>起始目录：查找文件的起始目录。</p> <h3 id="实例"><a href="#实例" class="header-anchor">#</a> 实例</h3> <h4 id="根据文件或者正则表达式进行匹配"><a href="#根据文件或者正则表达式进行匹配" class="header-anchor">#</a> 根据文件或者正则表达式进行匹配</h4> <p>列出当前目录及子目录下所有文件和文件夹</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find .
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在<code>/home</code>目录下查找以.txt结尾的文件名</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find /home -name &quot;*.txt&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>同上，但忽略大小写</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find /home -iname &quot;*.txt&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>当前目录及子目录下查找所有以.txt和.pdf结尾的文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . \( -name &quot;*.txt&quot; -o -name &quot;*.pdf&quot; \)

或

find . -name &quot;*.txt&quot; -o -name &quot;*.pdf&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>匹配文件路径或者文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find /usr/ -path &quot;*local*&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>基于正则表达式匹配文件路径</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -regex &quot;.*\(\.txt\|\.pdf\)$&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>同上，但忽略大小写</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -iregex &quot;.*\(\.txt\|\.pdf\)$&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="否定参数"><a href="#否定参数" class="header-anchor">#</a> 否定参数</h4> <p>找出/home下不是以.txt结尾的文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find /home ! -name &quot;*.txt&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="根据文件类型进行搜索"><a href="#根据文件类型进行搜索" class="header-anchor">#</a> 根据文件类型进行搜索</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -type 类型参数
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>类型参数列表：</p> <ul><li><strong>f</strong> 普通文件</li> <li><strong>l</strong> 符号连接</li> <li><strong>d</strong> 目录</li> <li><strong>c</strong> 字符设备</li> <li><strong>b</strong> 块设备</li> <li><strong>s</strong> 套接字</li> <li><strong>p</strong> Fifo</li></ul> <h4 id="基于目录深度搜索"><a href="#基于目录深度搜索" class="header-anchor">#</a> 基于目录深度搜索</h4> <p>向下最大深度限制为3</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -maxdepth 3 -type f
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>搜索出深度距离当前目录至少2个子目录的所有文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -mindepth 2 -type f
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="根据文件时间戳进行搜索"><a href="#根据文件时间戳进行搜索" class="header-anchor">#</a> 根据文件时间戳进行搜索</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -type f 时间戳
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>UNIX/Linux文件系统每个文件都有三种时间戳：</p> <ul><li><strong>访问时间</strong>（-atime/天，-amin/分钟）：用户最近一次访问时间。</li> <li><strong>修改时间</strong>（-mtime/天，-mmin/分钟）：文件最后一次修改时间。</li> <li><strong>变化时间</strong>（-ctime/天，-cmin/分钟）：文件数据元（例如权限等）最后一次修改时间。</li></ul> <p>搜索最近七天内被访问过的所有文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -type f -atime -7
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>搜索恰好在七天前被访问过的所有文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -type f -atime 7
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>搜索超过七天内被访问过的所有文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -type f -atime +7
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>搜索访问时间超过10分钟的所有文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -type f -amin +10
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>找出比<a href="http://man.linuxde.net/file" target="_blank" rel="noopener noreferrer">file<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.log修改时间更长的所有文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -type f -newer file.log
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="根据文件大小进行匹配"><a href="#根据文件大小进行匹配" class="header-anchor">#</a> 根据文件大小进行匹配</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -type f -size 文件大小单元
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>文件大小单元：</p> <ul><li><strong>b</strong> —— 块（512字节）</li> <li><strong>c</strong> —— 字节</li> <li><strong><a href="http://man.linuxde.net/w" target="_blank" rel="noopener noreferrer">w<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></strong> —— 字（2字节）</li> <li><strong>k</strong> —— 千字节</li> <li><strong>M</strong> —— 兆字节</li> <li><strong>G</strong> —— 吉字节</li></ul> <p>搜索大于10KB的文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -type f -size +10k
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>搜索小于10KB的文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -type f -size -10k
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>搜索等于10KB的文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -type f -size 10k
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="删除匹配文件"><a href="#删除匹配文件" class="header-anchor">#</a> 删除匹配文件</h4> <p>删除当前目录下所有.txt文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -type f -name &quot;*.txt&quot; -delete
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="根据文件权限-所有权进行匹配"><a href="#根据文件权限-所有权进行匹配" class="header-anchor">#</a> 根据文件权限/所有权进行匹配</h4> <p>当前目录下搜索出权限为777的文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -type f -perm 777
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>找出当前目录下权限不是644的<a href="http://man.linuxde.net/php" target="_blank" rel="noopener noreferrer">php<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -type f -name &quot;*.php&quot; ! -perm 644
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>找出当前目录用户tom拥有的所有文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -type f -user tom
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>找出当前目录用户组sunk拥有的所有文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -type f -group sunk
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="借助-exec选项与其他命令结合使用"><a href="#借助-exec选项与其他命令结合使用" class="header-anchor">#</a> 借助<code>-exec</code>选项与其他命令结合使用</h4> <p>找出当前目录下所有root的文件，并把所有权更改为用户tom</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find .-type f -user root -exec chown tom {} \;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>上例中，<strong>{}</strong> 用于与**-exec**选项结合使用来匹配所有文件，然后会被替换为相应的文件名。</p> <p>找出自己家目录下所有的.txt文件并删除</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find $HOME/. -name &quot;*.txt&quot; -ok rm {} \;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>上例中，<strong>-ok</strong>和**-exec**行为一样，不过它会给出提示，是否执行相应的操作。</p> <p>查找当前目录下所有.txt文件并把他们拼接起来写入到all.txt文件中</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -type f -name &quot;*.txt&quot; -exec cat {} \;&gt; all.txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>将30天前的.log文件移动到old目录中</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -type f -mtime +30 -name &quot;*.log&quot; -exec cp {} old \;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>找出当前目录下所有.txt文件并以“File:文件名”的形式打印出来</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -type f -name &quot;*.txt&quot; -exec printf &quot;File: %s\n&quot; {} \;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>因为单行命令中-exec参数中无法使用多个命令，以下方法可以实现在-exec之后接受多条命令</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>-exec ./text.sh {} \;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="搜索但跳出指定的目录"><a href="#搜索但跳出指定的目录" class="header-anchor">#</a> 搜索但跳出指定的目录</h4> <p>查找当前目录或者子目录下所有.txt文件，但是跳过子目录sk</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -path &quot;./sk&quot; -prune -o -name &quot;*.txt&quot; -print
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="find其他技巧收集"><a href="#find其他技巧收集" class="header-anchor">#</a> find其他技巧收集</h4> <p>要列出所有长度为零的文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -empty
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>find -print0表示在find的每一个结果之后加一个NULL字符，而不是默认加一个换行符。find的默认在每一个结果后加一个'\n'，所以输出结果是一行一行的。当使用了-print0之后，就变成一行了</p> <p>然后xargs -0表示xargs用NULL来作为分隔符。这样前后搭配就不会出现空格和换行符的错误了。选择NULL做分隔符，是因为一般编程语言把NULL作为字符串结束的标志，所以文件名不可能以NULL结尾，这样确保万无一失。</p> <p>find . -name &quot;*.txt&quot; -print0 | xargs -0 rm</p> <p>查找类型文件并修改内容</p> <p>find ./ -type f -regex &quot;.*.tpl&quot; | xargs sed -i &quot;s#MinDoc文档在线管理系统#小诺运维、运维笔记#g&quot;</p> <p>find ./ -type f -regex &quot;.*.tpl&quot; | xargs grep &quot;meta name=&quot;description&quot; content=&quot;</p> <h1 id="xargs命令"><a href="#xargs命令" class="header-anchor">#</a> xargs命令</h1> <p><strong>xargs命令</strong>是给其他命令传递参数的一个过滤器，也是组合多个命令的一个工具。它擅长将标准输入数据转换成命令行参数，xargs能够处理管道或者stdin并将其转换成特定命令的命令参数。xargs也可以将单行或多行文本输入转换为其他格式，例如多行变单行，单行变多行。xargs的默认命令是<a href="http://man.linuxde.net/echo" target="_blank" rel="noopener noreferrer">echo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，空格是默认定界符。这意味着通过管道传递给xargs的输入将会包含换行和空白，不过通过xargs的处理，换行和空白将被空格取代。xargs是构建单行命令的重要组件之一。</p> <h3 id="xargs命令用法"><a href="#xargs命令用法" class="header-anchor">#</a> xargs命令用法</h3> <p>xargs用作替换工具，读取输入数据重新格式化后输出。</p> <p>定义一个测试文件，内有多行文本数据：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cat test.txt

a b c d e f g
h i j k l m n
o p q
r s t
u v w x y z
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>多行输入单行输出：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cat test.txt | xargs

a b c d e f g h i j k l m n o p q r s t u v w x y z
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>-n选项</strong>多行输出：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cat test.txt | xargs -n3

a b c
d e f
g h i
j k l
m n o
p q r
s t u
v w x
y z
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>-d选项</strong>可以自定义一个定界符：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>echo &quot;nameXnameXnameXname&quot; | xargs -dX

name name name name
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>结合**-n选项**使用：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>echo &quot;nameXnameXnameXname&quot; | xargs -dX -n2

name name
name name
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>读取stdin，将格式化后的参数传递给命令</strong></p> <p>假设一个命令为 sk.sh 和一个保存参数的文件arg.txt：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/bin/bash
#sk.sh命令内容，打印出所有参数。

echo $*
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>arg.txt文件内容：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cat arg.txt

aaa
bbb
ccc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>xargs的一个<strong>选项-I</strong>，使用-I指定一个替换字符串{}，这个字符串在xargs扩展时会被替换掉，当-I与xargs结合使用，每一个参数命令都会被执行一次：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cat arg.txt | xargs -I {} ./sk.sh -p {} -l

-p aaa -l
-p bbb -l
-p ccc -l
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>复制所有图片文件到 /data/images 目录下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ls *.jpg | xargs -n1 -I cp {} /data/images
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>xargs结合<a href="http://man.linuxde.net/find" target="_blank" rel="noopener noreferrer">find<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>使用</strong></p> <p>用<a href="http://man.linuxde.net/rm" target="_blank" rel="noopener noreferrer">rm<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 删除太多的文件时候，可能得到一个错误信息：/bin/rm Argument list too long. 用xargs去避免这个问题：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -type f -name &quot;*.log&quot; -print0 | xargs -0 rm -f
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>xargs -0将\0作为定界符。</p> <p>统计一个源代码目录中所有<a href="http://man.linuxde.net/php" target="_blank" rel="noopener noreferrer">php<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>文件的行数：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -type f -name &quot;*.php&quot; -print0 | xargs -0 wc -l
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>查找所有的jpg 文件，并且压缩它们：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>find . -type f -name &quot;*.jpg&quot; -print | xargs tar -czvf images.tar.gz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>xargs其他应用</strong></p> <p>假如你有一个文件包含了很多你希望下载的URL，你能够使用xargs下载所有链接：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cat url-list.txt | xargs wget -c
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="子shell-subshells"><a href="#子shell-subshells" class="header-anchor">#</a> 子Shell（Subshells）</h3> <p>运行一个shell脚本时会启动另一个命令解释器.，就好像你的命令是在命令行提示下被解释的一样，类似于批处理文件里的一系列命令。每个shell脚本有效地运行在父shell(parent shell)的一个子进程里。这个父shell是指在一个控制终端或在一个xterm窗口中给你命令指示符的进程。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cmd1 | ( cmd2; cmd3; cmd4 ) | cmd5
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>如果cmd2 是<a href="http://man.linuxde.net/cd" target="_blank" rel="noopener noreferrer">cd<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> /，那么就会改变子Shell的工作目录，这种改变只是局限于子shell内部，cmd5则完全不知道工作目录发生的变化。子shell是嵌在圆括号()内部的命令序列，子Shell内部定义的变量为局部变量。</p> <p>子shell可用于为一组命令设定临时的环境变量：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>COMMAND1
COMMAND2
COMMAND3
(
  IFS=:
  PATH=/bin
  unset TERMINFO
  set -C
  shift 5
  COMMAND4
  COMMAND5
  exit 3 # 只是从子shell退出。
)
# 父shell不受影响，变量值没有更改。
COMMAND6
COMMAND7
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h1 id="tar命令"><a href="#tar命令" class="header-anchor">#</a> tar命令</h1> <p><strong>tar命令</strong>可以为linux的文件和目录创建档案。利用tar，可以为某一特定文件创建档案（备份文件），也可以在档案中改变文件，或者向档案中加入新的文件。tar最初被用来在磁带上创建档案，现在，用户可以在任何设备上创建档案。利用tar命令，可以把一大堆的文件和目录全部打包成一个文件，这对于备份文件或将几个文件组合成为一个文件以便于网络传输是非常有用的。</p> <p>首先要弄清两个概念：打包和压缩。打包是指将一大堆文件或目录变成一个总的文件；压缩则是将一个大的文件通过一些压缩算法变成一个小文件。</p> <p>为什么要区分这两个概念呢？这源于Linux中很多压缩程序只能针对一个文件进行压缩，这样当你想要压缩一大堆文件时，你得先将这一大堆文件先打成一个包（tar命令），然后再用压缩程序进行压缩（<a href="http://man.linuxde.net/gzip" target="_blank" rel="noopener noreferrer">gzip<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://man.linuxde.net/bzip2" target="_blank" rel="noopener noreferrer">bzip2<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>命令）。</p> <h3 id="语法-2"><a href="#语法-2" class="header-anchor">#</a> 语法</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>tar(选项)(参数)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="选项-2"><a href="#选项-2" class="header-anchor">#</a> 选项</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>-A或--catenate：新增文件到以存在的备份文件；
-B：设置区块大小；
-c或--create：建立新的备份文件；
-C &lt;目录&gt;：这个选项用在解压缩，若要在特定目录解压缩，可以使用这个选项。
-d：记录文件的差别；
-x或--extract或--get：从备份文件中还原文件；
-t或--list：列出备份文件的内容；
-z或--gzip或--ungzip：通过gzip指令处理备份文件；
-Z或--compress或--uncompress：通过compress指令处理备份文件；
-f&lt;备份文件&gt;或--file=&lt;备份文件&gt;：指定备份文件；
-v或--verbose：显示指令执行过程；
-r：添加文件到已经压缩的文件；
-u：添加改变了和现有的文件到已经存在的压缩文件；
-j：支持bzip2解压文件；
-v：显示操作过程；
-l：文件系统边界设置；
-k：保留原有文件不覆盖；
-m：保留文件不被覆盖；
-w：确认压缩文件的正确性；
-p或--same-permissions：用原来的文件权限还原文件；
-P或--absolute-names：文件名使用绝对名称，不移除文件名称前的“/”号；
-N &lt;日期格式&gt; 或 --newer=&lt;日期时间&gt;：只将较指定日期更新的文件保存到备份文件里；
--exclude=&lt;范本样式&gt;：排除符合范本样式的文件。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="参数-2"><a href="#参数-2" class="header-anchor">#</a> 参数</h3> <p>文件或目录：指定要打包的文件或目录列表。</p> <h3 id="实例-2"><a href="#实例-2" class="header-anchor">#</a> 实例</h3> <p><strong>将文件全部打包成tar包</strong>：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>tar -cvf log.tar log2012.log    仅打包，不压缩！ 
tar -zcvf log.tar.gz log2012.log   打包后，以 gzip 压缩 
tar -jcvf log.tar.bz2 log2012.log  打包后，以 bzip2 压缩 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>在选项<code>f</code>之后的文件档名是自己取的，我们习惯上都用 .tar 来作为辨识。 如果加<code>z</code>选项，则以.tar.gz或.tgz来代表gzip压缩过的tar包；如果加<code>j</code>选项，则以.tar.bz2来作为tar包名。</p> <p><strong>查阅上述tar包内有哪些文件</strong>：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>tar -ztvf log.tar.gz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>由于我们使用 gzip 压缩的log.tar.gz，所以要查阅log.tar.gz包内的文件时，就得要加上<code>z</code>这个选项了。</p> <p><strong>将tar包解压缩</strong>：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>tar -zxvf /opt/soft/test/log.tar.gz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在预设的情况下，我们可以将压缩档在任何地方解开的</p> <p><strong>只将tar内的部分文件解压出来</strong>：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>tar -zxvf /opt/soft/test/log30.tar.gz log2013.log
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>我可以透过<code>tar -ztvf</code>来查阅 tar 包内的文件名称，如果单只要一个文件，就可以透过这个方式来解压部分文件！</p> <p><strong>文件备份下来，并且保存其权限</strong>：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>tar -zcvpf log31.tar.gz log2014.log log2015.log log2016.log
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这个<code>-p</code>的属性是很重要的，尤其是当您要保留原本文件的属性时。</p> <p><strong>在文件夹当中，比某个日期新的文件才备份</strong>：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>tar -N &quot;2012/11/13&quot; -zcvf log17.tar.gz test
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>备份文件夹内容是排除部分文件：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>tar --exclude scf/service -zcvf scf.tar.gz scf/*
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>其实最简单的使用 tar 就只要记忆底下的方式即可：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>压　缩：tar -jcv -f filename.tar.bz2 要被压缩的文件或目录名称
查　询：tar -jtv -f filename.tar.bz2
解压缩：tar -jxv -f filename.tar.bz2 -C 欲解压缩的目录
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h1 id="date命令"><a href="#date命令" class="header-anchor">#</a> date命令</h1> <p><strong>date命令</strong>是显示或设置系统时间与日期。</p> <p>很多shell脚本里面需要打印不同格式的时间或日期，以及要根据时间和日期执行操作。延时通常用于脚本执行过程中提供一段等待的时间。日期可以以多种格式去打印，也可以使用命令设置固定的格式。在类UNIX系统中，日期被存储为一个整数，其大小为自世界标准时间（UTC）1970年1月1日0时0分0秒起流逝的秒数。</p> <h3 id="语法-3"><a href="#语法-3" class="header-anchor">#</a> 语法</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>date(选项)(参数)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="选项-3"><a href="#选项-3" class="header-anchor">#</a> 选项</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>-d&lt;字符串&gt;：显示字符串所指的日期与时间。字符串前后必须加上双引号；
-s&lt;字符串&gt;：根据字符串来设置日期与时间。字符串前后必须加上双引号；
-u：显示GMT；
--help：在线帮助；
--version：显示版本信息。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="参数-3"><a href="#参数-3" class="header-anchor">#</a> 参数</h3> <p>&lt;+时间日期格式&gt;：指定显示时使用的日期时间格式。</p> <h3 id="日期格式字符串列表"><a href="#日期格式字符串列表" class="header-anchor">#</a> 日期格式字符串列表</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>%H 小时，24小时制（00~23）
%I 小时，12小时制（01~12）
%k 小时，24小时制（0~23）
%l 小时，12小时制（1~12）
%M 分钟（00~59）
%p 显示出AM或PM
%r 显示时间，12小时制（hh:mm:ss %p）
%s 从1970年1月1日00:00:00到目前经历的秒数
%S 显示秒（00~59）
%T 显示时间，24小时制（hh:mm:ss）
%X 显示时间的格式（%H:%M:%S）
%Z 显示时区，日期域（CST）
%a 星期的简称（Sun~Sat）
%A 星期的全称（Sunday~Saturday）
%h,%b 月的简称（Jan~Dec）
%B 月的全称（January~December）
%c 日期和时间（Tue Nov 20 14:12:58 2012）
%d 一个月的第几天（01~31）
%x,%D 日期（mm/dd/yy）
%j 一年的第几天（001~366）
%m 月份（01~12）
%w 一个星期的第几天（0代表星期天）
%W 一年的第几个星期（00~53，星期一为第一天）
%y 年的最后两个数字（1999则是99）
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="实例-3"><a href="#实例-3" class="header-anchor">#</a> 实例</h3> <p>格式化输出：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>date +&quot;%Y-%m-%d&quot;
2009-12-07
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>输出昨天日期：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>date -d &quot;1 day ago&quot; +&quot;%Y-%m-%d&quot;
2012-11-19
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>2秒后输出：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>date -d &quot;2 second&quot; +&quot;%Y-%m-%d %H:%M.%S&quot;
2012-11-20 14:21.31
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>传说中的 1234567890 秒：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>date -d &quot;1970-01-01 1234567890 seconds&quot; +&quot;%Y-%m-%d %H:%m:%S&quot;
2009-02-13 23:02:30
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>普通转格式：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>date -d &quot;2009-12-12&quot; +&quot;%Y/%m/%d %H:%M.%S&quot;
2009/12/12 00:00.00
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>apache格式转换：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>date -d &quot;Dec 5, 2009 12:00:37 AM&quot; +&quot;%Y-%m-%d %H:%M.%S&quot;
2009-12-05 00:00.37
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>格式转换后时间游走：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>date -d &quot;Dec 5, 2009 12:00:37 AM 2 year ago&quot; +&quot;%Y-%m-%d %H:%M.%S&quot;
2007-12-05 00:00.37
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>加减操作：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>date +%Y%m%d                   //显示前天年月日
date -d &quot;+1 day&quot; +%Y%m%d       //显示前一天的日期
date -d &quot;-1 day&quot; +%Y%m%d       //显示后一天的日期
date -d &quot;-1 month&quot; +%Y%m%d     //显示上一月的日期
date -d &quot;+1 month&quot; +%Y%m%d     //显示下一月的日期
date -d &quot;-1 year&quot; +%Y%m%d      //显示前一年的日期
date -d &quot;+1 year&quot; +%Y%m%d      //显示下一年的日期
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>设定时间：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>date -s                        //设置当前时间，只有root权限才能设置，其他只能查看
date -s 20120523               //设置成20120523，这样会把具体时间设置成空00:00:00
date -s 01:01:01               //设置具体时间，不会对日期做更改
date -s &quot;01:01:01 2012-05-23&quot;  //这样可以设置全部时间
date -s &quot;01:01:01 20120523&quot;    //这样可以设置全部时间
date -s &quot;2012-05-23 01:01:01&quot;  //这样可以设置全部时间
date -s &quot;20120523 01:01:01&quot;    //这样可以设置全部时间
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>有时需要检查一组命令花费的时间，举例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/bin/bash

start=$(date +%s)
nmap man.linuxde.net &amp;&gt; /dev/null

end=$(date +%s)
difference=$(( end - start ))
echo $difference seconds.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h1 id="dd命令"><a href="#dd命令" class="header-anchor">#</a> dd命令</h1> <p><strong>dd命令</strong>用于复制文件并对原文件的内容进行转换和格式化处理。dd命令功能很强大的，对于一些比较底层的问题，使用dd命令往往可以得到出人意料的效果。用的比较多的还是用dd来备份裸设备。但是不推荐，如果需要备份oracle裸设备，可以使用rman备份，或使用第三方软件备份，使用dd的话，管理起来不太方便。</p> <p>建议在有需要的时候使用dd 对物理磁盘操作，如果是文件系统的话还是使用<a href="http://man.linuxde.net/tar" target="_blank" rel="noopener noreferrer">tar<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> backup <a href="http://man.linuxde.net/cpio" target="_blank" rel="noopener noreferrer">cpio<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>等其他命令更加方便。另外，使用dd对磁盘操作时，最好使用块设备文件。</p> <h3 id="语法-4"><a href="#语法-4" class="header-anchor">#</a> 语法</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>dd(选项)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="选项-4"><a href="#选项-4" class="header-anchor">#</a> 选项</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>bs=&lt;字节数&gt;：将 ibs（输入）与 obs（输出）设成指定的字节数；
cbs=&lt;字节数&gt;：转换时，每次只转换指定的字节数；
conv=&lt;关键字&gt;：指定文件转换的方式；
count=&lt;区块数&gt;：仅读取指定的区块数；
ibs=&lt;字节数&gt;：每次读取的字节数；
obs=&lt;字节数&gt;：每次输出的字节数；
of=&lt;文件&gt;：输出到文件；
seek=&lt;区块数&gt;：一开始输出时，跳过指定的区块数；
skip=&lt;区块数&gt;：一开始读取时，跳过指定的区块数；
--help：帮助；
--version：显示版本信息。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="实例-4"><a href="#实例-4" class="header-anchor">#</a> 实例</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@localhost text]# dd if=/dev/zero of=sun.txt bs=1M count=1
1+0 records in
1+0 records out
1048576 bytes (1.0 MB) copied, 0.006107 seconds, 172 MB/s

[root@localhost text]# du -sh sun.txt 
1.1M    sun.txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>该命令创建了一个1M大小的文件sun.txt，其中参数解释：</p> <ul><li><strong>if</strong> 代表输入文件。如果不指定if，默认就会从stdin中读取输入。</li> <li><strong>of</strong> 代表输出文件。如果不指定of，默认就会将stdout作为默认输出。</li> <li><strong>bs</strong> 代表字节为单位的块大小。</li> <li><strong>count</strong> 代表被复制的块数。</li> <li><strong>/dev/zero</strong> 是一个字符设备，会不断返回0值字节（\0）。</li></ul> <p>块大小可以使用的计量单位表</p> <table><thead><tr><th>单元大小</th> <th>代码</th></tr></thead> <tbody><tr><td>字节（1B）</td> <td>c</td></tr> <tr><td>字节（2B）</td> <td><a href="http://man.linuxde.net/w" target="_blank" rel="noopener noreferrer">w<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td></tr> <tr><td>块（512B）</td> <td>b</td></tr> <tr><td>千字节（1024B）</td> <td>k</td></tr> <tr><td>兆字节（1024KB）</td> <td>M</td></tr> <tr><td>吉字节（1024MB）</td> <td>G</td></tr></tbody></table> <p>以上命令可以看出dd命令来测试内存操作速度：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>1048576 bytes (1.0 MB) copied, 0.006107 seconds, 172 MB/s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h1 id="curl命令"><a href="#curl命令" class="header-anchor">#</a> curl命令</h1> <p><strong>curl命令</strong>是一个利用URL规则在命令行下工作的文件传输工具。它支持文件的上传和下载，所以是综合传输工具，但按传统，习惯称curl为下载工具。作为一款强力工具，curl支持包括HTTP、HTTPS、<a href="http://man.linuxde.net/ftp" target="_blank" rel="noopener noreferrer">ftp<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>等众多协议，还支持POST、cookies、认证、从指定偏移处下载部分文件、用户代理字符串、限速、文件大小、进度条等特征。做网页处理流程和数据检索自动化，curl可以祝一臂之力。</p> <h3 id="语法-5"><a href="#语法-5" class="header-anchor">#</a> 语法</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>curl(选项)(参数)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="选项-5"><a href="#选项-5" class="header-anchor">#</a> 选项</h3> <table><thead><tr><th>-a/--append</th> <th>上传文件时，附加到目标文件</th></tr></thead> <tbody><tr><td>-A/--user-agent <string></string></td> <td>设置用户代理发送给服务器</td></tr> <tr><td>-anyauth</td> <td>可以使用“任何”身份验证方法</td></tr> <tr><td>-b/--cookie &lt;name=string/<a href="http://man.linuxde.net/file" target="_blank" rel="noopener noreferrer">file<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>&gt;</td> <td>cookie字符串或文件读取位置</td></tr> <tr><td>--basic</td> <td>使用HTTP基本验证</td></tr> <tr><td>-B/--use-ascii</td> <td>使用ASCII /文本传输</td></tr> <tr><td>-c/--cookie-jar <file></file></td> <td>操作结束后把cookie写入到这个文件中</td></tr> <tr><td>-C/--continue-<a href="http://man.linuxde.net/at" target="_blank" rel="noopener noreferrer">at<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <offset></offset></td> <td>断点续转</td></tr> <tr><td>-d/--data <data></data></td> <td>HTTP POST方式传送数据</td></tr> <tr><td>--data-ascii <data></data></td> <td>以ascii的方式post数据</td></tr> <tr><td>--data-binary <data></data></td> <td>以二进制的方式post数据</td></tr> <tr><td>--negotiate</td> <td>使用HTTP身份验证</td></tr> <tr><td>--digest</td> <td>使用数字身份验证</td></tr> <tr><td>--disable-eprt</td> <td>禁止使用EPRT或LPRT</td></tr> <tr><td>--disable-epsv</td> <td>禁止使用EPSV</td></tr> <tr><td>-D/--<a href="http://man.linuxde.net/dump" target="_blank" rel="noopener noreferrer">dump<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>-header <file></file></td> <td>把header信息写入到该文件中</td></tr> <tr><td>--egd-file <file></file></td> <td>为随机数据(SSL)设置EGD socket路径</td></tr> <tr><td>--tcp-nodelay</td> <td>使用TCP_NODELAY选项</td></tr> <tr><td>-e/--referer</td> <td>来源网址</td></tr> <tr><td>-E/--cert &lt;cert[:<a href="http://man.linuxde.net/passwd" target="_blank" rel="noopener noreferrer">passwd<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>]&gt;</td> <td>客户端证书文件和密码 (SSL)</td></tr> <tr><td>--cert-<a href="http://man.linuxde.net/type" target="_blank" rel="noopener noreferrer">type<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <type></type></td> <td>证书文件类型 (DER/PEM/ENG) (SSL)</td></tr> <tr><td>--key <key></key></td> <td>私钥文件名 (SSL)</td></tr> <tr><td>--key-type <type></type></td> <td>私钥文件类型 (DER/PEM/ENG) (SSL)</td></tr> <tr><td>--pass <pass></pass></td> <td>私钥密码 (SSL)</td></tr> <tr><td>--engine <eng></eng></td> <td>加密引擎使用 (SSL). &quot;--engine list&quot; for list</td></tr> <tr><td>--cacert <file></file></td> <td>CA证书 (SSL)</td></tr> <tr><td>--capath <directory></directory></td> <td>CA目录 (made using c_rehash) to verify peer against (SSL)</td></tr> <tr><td>--ciphers <list></list></td> <td>SSL密码</td></tr> <tr><td>--compressed</td> <td>要求返回是压缩的形势 (using deflate or <a href="http://man.linuxde.net/gzip" target="_blank" rel="noopener noreferrer">gzip<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</td></tr> <tr><td>--connect-timeout <seconds></seconds></td> <td>设置最大请求时间</td></tr> <tr><td>--create-<a href="http://man.linuxde.net/dirs" target="_blank" rel="noopener noreferrer">dirs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>建立本地目录的目录层次结构</td></tr> <tr><td>--crlf</td> <td>上传是把LF转变成CRLF</td></tr> <tr><td>-f/--fail</td> <td>连接失败时不显示http错误</td></tr> <tr><td>--ftp-create-dirs</td> <td>如果远程目录不存在，创建远程目录</td></tr> <tr><td>--ftp-method [multicwd/nocwd/singlecwd]</td> <td>控制CWD的使用</td></tr> <tr><td>--ftp-pasv</td> <td>使用 PASV/EPSV 代替端口</td></tr> <tr><td>--ftp-skip-pasv-<a href="http://man.linuxde.net/ip" target="_blank" rel="noopener noreferrer">ip<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>使用PASV的时候,忽略该IP地址</td></tr> <tr><td>--ftp-ssl</td> <td>尝试用 SSL/TLS 来进行ftp数据传输</td></tr> <tr><td>--ftp-ssl-reqd</td> <td>要求用 SSL/TLS 来进行ftp数据传输</td></tr> <tr><td>-F/--form &lt;name=content&gt;</td> <td>模拟http表单提交数据</td></tr> <tr><td>--form-string &lt;name=string&gt;</td> <td>模拟http表单提交数据</td></tr> <tr><td>-g/--globoff</td> <td>禁用网址序列和范围使用{}和[]</td></tr> <tr><td>-G/--get</td> <td>以get的方式来发送数据</td></tr> <tr><td>-H/--header <line></line></td> <td>自定义头信息传递给服务器</td></tr> <tr><td>--ignore-content-length</td> <td>忽略的HTTP头信息的长度</td></tr> <tr><td>-i/--include</td> <td>输出时包括protocol头信息</td></tr> <tr><td>-I/--<a href="http://man.linuxde.net/head" target="_blank" rel="noopener noreferrer">head<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>只显示请求头信息</td></tr> <tr><td>-j/--junk-session-cookies</td> <td>读取文件进忽略session cookie</td></tr> <tr><td>--interface <interface></interface></td> <td>使用指定网络接口/地址</td></tr> <tr><td>--krb4 <level></level></td> <td>使用指定安全级别的krb4</td></tr> <tr><td>-k/--insecure</td> <td>允许不使用证书到SSL站点</td></tr> <tr><td>-K/--config</td> <td>指定的配置文件读取</td></tr> <tr><td>-l/--list-only</td> <td>列出ftp目录下的文件名称</td></tr> <tr><td>--limit-rate <rate></rate></td> <td>设置传输速度</td></tr> <tr><td>--local-port<NUM></NUM></td> <td>强制使用本地端口号</td></tr> <tr><td>-m/--max-<a href="http://man.linuxde.net/time" target="_blank" rel="noopener noreferrer">time<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <seconds></seconds></td> <td>设置最大传输时间</td></tr> <tr><td>--max-redirs <num></num></td> <td>设置最大读取的目录数</td></tr> <tr><td>--max-filesize <bytes></bytes></td> <td>设置最大下载的文件总量</td></tr> <tr><td>-M/--manual</td> <td>显示全手动</td></tr> <tr><td>-n/--netrc</td> <td>从netrc文件中读取用户名和密码</td></tr> <tr><td>--netrc-optional</td> <td>使用 .netrc 或者 URL来覆盖-n</td></tr> <tr><td>--ntlm</td> <td>使用 HTTP NTLM 身份验证</td></tr> <tr><td>-N/--no-buffer</td> <td>禁用缓冲输出</td></tr> <tr><td>-o/--output</td> <td>把输出写到该文件中</td></tr> <tr><td>-O/--remote-name</td> <td>把输出写到该文件中，保留远程文件的文件名</td></tr> <tr><td>-p/--proxytunnel</td> <td>使用HTTP代理</td></tr> <tr><td>--proxy-anyauth</td> <td>选择任一代理身份验证方法</td></tr> <tr><td>--proxy-basic</td> <td>在代理上使用基本身份验证</td></tr> <tr><td>--proxy-digest</td> <td>在代理上使用数字身份验证</td></tr> <tr><td>--proxy-ntlm</td> <td>在代理上使用ntlm身份验证</td></tr> <tr><td>-P/--ftp-port <address></address></td> <td>使用端口地址，而不是使用PASV</td></tr> <tr><td>-q</td> <td>作为第一个参数，关闭 .curlrc</td></tr> <tr><td>-Q/--quote <cmd></cmd></td> <td>文件传输前，发送命令到服务器</td></tr> <tr><td>-r/--range <range></range></td> <td>检索来自HTTP/1.1或FTP服务器字节范围</td></tr> <tr><td>--range-file</td> <td>读取（SSL）的随机文件</td></tr> <tr><td>-R/--remote-time</td> <td>在本地生成文件时，保留远程文件时间</td></tr> <tr><td>--retry <num></num></td> <td>传输出现问题时，重试的次数</td></tr> <tr><td>--retry-delay <seconds></seconds></td> <td>传输出现问题时，设置重试间隔时间</td></tr> <tr><td>--retry-max-time <seconds></seconds></td> <td>传输出现问题时，设置最大重试时间</td></tr> <tr><td>-s/--silent</td> <td>静默模式。不输出任何东西</td></tr> <tr><td>-S/--show-error</td> <td>显示错误</td></tr> <tr><td>--socks4 &lt;<a href="http://man.linuxde.net/host" target="_blank" rel="noopener noreferrer">host<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>[:port]&gt;</td> <td>用socks4代理给定主机和端口</td></tr> <tr><td>--socks5 &lt;host[:port]&gt;</td> <td>用socks5代理给定主机和端口</td></tr> <tr><td>--stderr <file></file></td> <td></td></tr> <tr><td>-t/--<a href="http://man.linuxde.net/telnet" target="_blank" rel="noopener noreferrer">telnet<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>-option &lt;OPT=val&gt;</td> <td>Telnet选项设置</td></tr> <tr><td>--trace <file></file></td> <td>对指定文件进行debug</td></tr> <tr><td>--trace-ascii <file></file></td> <td>Like --跟踪但没有hex输出</td></tr> <tr><td>--trace-time</td> <td>跟踪/详细输出时，添加时间戳</td></tr> <tr><td>-T/--upload-file <file></file></td> <td>上传文件</td></tr> <tr><td>--url <URL></URL></td> <td>Spet URL to work with</td></tr> <tr><td>-u/--user &lt;user[:password]&gt;</td> <td>设置服务器的用户和密码</td></tr> <tr><td>-U/--proxy-user &lt;user[:password]&gt;</td> <td>设置代理用户名和密码</td></tr> <tr><td>-<a href="http://man.linuxde.net/w" target="_blank" rel="noopener noreferrer">w<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>/--<a href="http://man.linuxde.net/write" target="_blank" rel="noopener noreferrer">write<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>-out [format]</td> <td>什么输出完成后</td></tr> <tr><td>-x/--proxy &lt;host[:port]&gt;</td> <td>在给定的端口上使用HTTP代理</td></tr> <tr><td>-X/--request &lt;<a href="http://man.linuxde.net/command" target="_blank" rel="noopener noreferrer">command<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>&gt;</td> <td>指定什么命令</td></tr> <tr><td>-y/--speed-time</td> <td>放弃限速所要的时间，默认为30</td></tr> <tr><td>-Y/--speed-limit</td> <td>停止传输速度的限制，速度时间</td></tr></tbody></table> <h3 id="实例-5"><a href="#实例-5" class="header-anchor">#</a> 实例</h3> <p><strong>文件下载</strong></p> <p>curl命令可以用来执行下载、发送各种HTTP请求，指定HTTP头部等操作。如果系统没有curl可以使用<code>yum install curl</code>安装，也可以下载安装。curl是将下载文件输出到stdout，将进度信息输出到stderr，不显示进度信息使用<code>--silent</code>选项。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>curl URL --silent
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这条命令是将下载文件输出到终端，所有下载的数据都被写入到stdout。</p> <p>使用选项<code>-O</code>将下载的数据写入到文件，必须使用文件的绝对地址：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>curl http://man.linuxde.net/text.iso --silent -O
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>选项<code>-o</code>将下载数据写入到指定名称的文件中，并使用<code>--progress</code>显示进度条：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>curl http://man.linuxde.net/test.iso -o filename.iso --progress
######################################### 100.0%
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>断点续传</strong></p> <p>curl能够从特定的文件偏移处继续下载，它可以通过指定一个便移量来下载部分文件：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>curl URL/File -C 偏移量

#偏移量是以字节为单位的整数，如果让curl自动推断出正确的续传位置使用-C -：
curl -C -URL
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>使用curl设置参照页字符串</strong></p> <p>参照页是位于HTTP头部中的一个字符串，用来表示用户是从哪个页面到达当前页面的，如果用户点击网页A中的某个连接，那么用户就会跳转到B网页，网页B头部的参照页字符串就包含网页A的URL。</p> <p>使用<code>--referer</code>选项指定参照页字符串：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>curl --referer http://www.google.com http://man.linuxde.net
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>用curl设置cookies</strong></p> <p>使用<code>--cookie &quot;COKKIES&quot;</code>选项来指定cookie，多个cookie使用分号分隔：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>curl http://man.linuxde.net --cookie &quot;user=root;pass=123456&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>将cookie另存为一个文件，使用<code>--cookie-jar</code>选项：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>curl URL --cookie-jar cookie_file
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>用curl设置用户代理字符串</strong></p> <p>有些网站访问会提示只能使用IE浏览器来访问，这是因为这些网站设置了检查用户代理，可以使用curl把用户代理设置为IE，这样就可以访问了。使用<code>--user-agent</code>或者<code>-A</code>选项：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>curl URL --user-agent &quot;Mozilla/5.0&quot;
curl URL -A &quot;Mozilla/5.0&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>其他HTTP头部信息也可以使用curl来发送，使用<code>-H</code>&quot;头部信息&quot; 传递多个头部信息，例如：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>curl -H &quot;Host:man.linuxde.net&quot; -H &quot;accept-language:zh-cn&quot; URL
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>curl的带宽控制和下载配额</strong></p> <p>使用<code>--limit-rate</code>限制curl的下载速度：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>curl URL --limit-rate 50k
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>命令中用k（千字节）和m（兆字节）指定下载速度限制。</p> <p>使用<code>--max-filesize</code>指定可下载的最大文件大小：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>curl URL --max-filesize bytes
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>如果文件大小超出限制，命令则返回一个非0退出码，如果命令正常则返回0。</p> <p><strong>用curl进行认证</strong></p> <p>使用curl选项 -u 可以完成HTTP或者FTP的认证，可以指定密码，也可以不指定密码在后续操作中输入密码：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>curl -u user:pwd http://man.linuxde.net
curl -u user http://man.linuxde.net
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>只打印响应头部信息</strong></p> <p>通过<code>-I</code>或者<code>-head</code>可以只打印出HTTP头部信息：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@localhost text]# curl -I http://man.linuxde.net
HTTP/1.1 200 OK
Server: nginx/1.2.5
date: Mon, 10 Dec 2012 09:24:34 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
X-Pingback: http://man.linuxde.net/xmlrpc.php
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h1 id="shell脚本中的while-getopts用法"><a href="#shell脚本中的while-getopts用法" class="header-anchor">#</a> Shell脚本中的while getopts用法</h1> <p>getpots是Shell命令行参数解析工具，旨在从Shell Script的命令行当中解析参数。getopts被Shell程序用来分析位置参数，option包含需要被识别的选项字符，<strong>如果这里的字符后面跟着一个冒号，表明该字符选项需要一个参数，其参数需要以空格分隔</strong>。冒号和问号不能被用作选项字符。getopts每次被调用时，它会将下一个选项字符放置到变量中，OPTARG则可以拿到参数值；如果option前面加冒号，则代表忽略错误；</p> <p><strong>命令格式：</strong></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>getopts optstring name <span class="token punctuation">[</span>arg<span class="token operator">...</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>命令描述：</strong> optstring列出了对应的Shell Script可以识别的所有参数。比如：如果 Shell Script可以识别-a，-f以及-s参数，则optstring就是afs；如果对应的参数后面还跟随一个值，则在相应的optstring后面加冒号。比如，a:fs 表示a参数后面会有一个值出现，-a value的形式。另外，getopts执行匹配到a的时候，会把value存放在一个叫OPTARG的Shell Variable当中。如果 optstring是以冒号开头的，命令行当中出现了optstring当中没有的参数将不会提示错误信息。</p> <p>name表示的是参数的名称，每次执行getopts，会从命令行当中获取下一个参数，然后存放到name当中。如果获取到的参数不在optstring当中列出，则name的值被设置为?。命令行当中的所有参数都有一个index，第一个参数从1开始，依次类推。 另外有一个名为OPTIND的Shell Variable存放下一个要处理的参数的index。</p> <h1 id="shell编程之expect自动化交互程序"><a href="#shell编程之expect自动化交互程序" class="header-anchor">#</a> Shell编程之Expect自动化交互程序</h1> <h2 id="expect自动化交互程序"><a href="#expect自动化交互程序" class="header-anchor">#</a> Expect自动化交互程序</h2> <h3 id="_1-spawn命令"><a href="#_1-spawn命令" class="header-anchor">#</a> 1.spawn命令</h3> <p>通过spawn执行一个命令或程序，之后所有的Expect操作都会在这个执行过的命令或程序进程中进行，包括自动交互功能。</p> <p>语法：
spawn [ 选项 ] [ 需要自动交互的命令或程序 ]</p> <ul><li>-open 表示启动文件进程</li> <li>-ignore 表示忽略某些信号</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>spawn ssh root@192.168.1.1 uptime
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_2-expect命令"><a href="#_2-expect命令" class="header-anchor">#</a> 2.expect命令</h3> <p>获取spawn命令执行后的信息，看卡是否和其事先指定的相匹配，一旦匹配上指定的内容就执行expect</p> <p>语法：
expect 表达式 [ 动作 ]</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>spawn ssh root@192.168.1.1 uptime
expect &quot;*password&quot; {sshd &quot;123456\r&quot;}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_3-expect实践"><a href="#_3-expect实践" class="header-anchor">#</a> 3.expect实践</h3> <p>（1）执行ssh命令远程获取服务器负载，并实现自动输入密码</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@codis-178 ~]# cat 18_1.sh 
#!/bin/expect
#Author:xiaoda
#Time:2017-09-06 11:53:30
#Name:18_1.sh
#Version:V1.0
#Description:This is a test script

spawn ssh -p12541 test@192.168.1.22 uptime
expect &quot;*password&quot; {send &quot;123456\n&quot;}

expect eof
[root@codis-178 ~]# expect 18_1.sh 
spawn ssh -p12541 test@192.168.1.22 uptime
Address 192.168.1.22 maps to localhost, but this does not map back to the address - POSSIBLE BREAK-IN ATTEMPT!
test@192.168.1.22's password: 
 11:56:01 up 1754 days, 23:53,  0 users,  load average: 0.00, 0.00, 0.00
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>说明：
通过spawn执行ssh后，系统会提示输入密码，expect按照匹配password字符串，之后根据send或exp_send动作执行。</p> <p>（2）执行ssh命令远程获取服务器负载，并自动输入“yes”及用户密码</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@codis-178 ~]# cat 18_2.sh 
#!/bin/expect
#Author:xiaoda
#Time:2017-09-06 11:53:30
#Name:18_1.sh
#Version:V1.0
#Description:This is a test script

spawn ssh -p12541 test@192.168.1.22 uptime
expect {
	&quot;yes/no&quot; {exp_send &quot;yes\r&quot;;exp_continue}
	&quot;*password&quot; {exp_send &quot;12345465\r&quot;}
}
expect eof
 
[root@codis-178 ~]# expect 18_2.sh 
spawn ssh -p12541 test@192.168.1.22 uptime
Address 192.168.1.22 maps to localhost, but this does not map back to the address - POSSIBLE BREAK-IN ATTEMPT!
test@192.168.1.22's password: 
 12:03:18 up 1755 days, 1 min,  0 users,  load average: 0.00, 0.00, 0.00
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>（3）利用expect响应Shell脚本中的多个read读入</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@codis-178 ~]# cat 18_3_1.sh
#!/bin/bash
#Author:xiaoda
#Time:2017-09-06 12:05:38
#Name:18_3_1.sh
#Version:V1.0
#Description:This is a test script

read -p 'Please input your username:' name
read -p 'Please input your password:' pass
read -p 'Please input your email:' email
echo -n &quot;your name is $name.&quot;
echo -n &quot;your password is $pass.&quot;
echo &quot;your email is $email.&quot;

[root@codis-178 ~]# cat 18_3_2.sh
#!/bin/expect
#Author:xiaoda
#Time:2017-09-06 12:07:37
#Name:18_3_2.sh
#Version:V1.0
#Description:This is a test script

spawn /bin/sh 18_3_1.sh
expect {
	&quot;username&quot; {exp_send &quot;oldboy\r&quot;;exp_continue}
	&quot;*pass*&quot; {send &quot;123456\r&quot;;exp_continue}
	&quot;*email*&quot; {exp_send &quot;12313@.qq.com\r&quot;}
}
expect eof'

[root@codis-178 ~]# expect 18_3_2.sh 
spawn /bin/sh 18_3_1.sh
Please input your username:oldboy
Please input your password:123456
Please input your email:12313@.qq.com
your name is oldboy.your password is 123456.your email is 12313@.qq.com.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h3 id="_4-命令简介"><a href="#_4-命令简介" class="header-anchor">#</a> 4.命令简介</h3> <p>（1）send命令
发送指定的字符串给系统</p> <p>（2）exp_continue命令
让Expect程序继续匹配</p> <p>（3）send_user命令
用来打印Expect脚本信息，类似echo</p> <p>（4）exit命令
直接退出Expect脚本</p> <p><img src="https://image.aomtop.com/i/2022/06/13/62a6e32f60228.png" alt="img"></p> <h3 id="_5-expect关键字"><a href="#_5-expect关键字" class="header-anchor">#</a> 5.Expect关键字</h3> <p>（1）eof
用于匹配结束符</p> <p>（2）timeout
控制时间，是一个全局性的时间控制开关，可以通过为这个变量赋值来规定整个Expect操作的时间
（即使命令没有任何错误，到了时间仍然会激活这个变量）</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>spqwn ssh root@192.168.1.1 uptime
set timeout 30
expect &quot;yes/no&quot; {exp_send &quot;yes\r&quot;;exp_continue}
expect timeout {puts &quot;Request timeout by oldboy.&quot;;return}
spqwn ssh root@192.168.1.1 uptime
expect {
    -timeout 3
    expect &quot;yes/no&quot; {exp_send &quot;yes\r&quot;;exp_continue}
    expect timeout {puts &quot;Request timeout by oldboy.&quot;;return}
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="_6-企业应用"><a href="#_6-企业应用" class="header-anchor">#</a> 6.企业应用</h3> <p>（1）实现Expect自动交互</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/usr/bin/expect
if [ $argc != 2 ] {
    puts &quot;usage: expect $argv0 ip command&quot;
    exit
}

set ip [lindex $argv 0]
set cmd [lindex $argv 1]
set password &quot;123456&quot;

spawn ssh root@192.168.1.1 $cmd
expect {
    expect &quot;yes/no&quot; {exp_send &quot;yes\r&quot;;exp_continue}
    &quot;*password&quot; {send &quot;$password\r&quot;}
}
export eof
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>（2）批量发送文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#!/usr/bin/expect
if [ $argc != 3 ] {
    puts &quot;usage: expect $argv0 file host dir&quot;
    exit
}

set file [lindex $argv 0]
set host [lindex $argv 1]
set dir [lindex $argv 2]
set password &quot;123456&quot;

spawn ssh -P22 root@192.168.1.1 $cmd
expect {
    expect &quot;yes/no&quot; {exp_send &quot;yes\r&quot;;exp_continue}
    &quot;*password&quot; {send &quot;$password\r&quot;}
}
export eof

#!/bin/bash
if [ $# -ne 2 ];then
    echo $&quot;Usage:$0 file dir&quot;
    exit 1
fi
file=$1
dir=$2
for n in 128 129 130
do
    expect 18_13_1.exp $file 192.168.1.$n $dir
done


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h3 id="_7-关于使用expect自动退出"><a href="#_7-关于使用expect自动退出" class="header-anchor">#</a> 7.关于使用expect自动退出</h3> <p>interact:表示登录远程机器后保留在登录的机器。如果不加这个interact,则登录后立马退出。或者使用 expect eof 这个命令，则会在登录机器后的2-3s后退出</p> <p>不支持在EOF中使用</p> <h3 id="_8-设置变量"><a href="#_8-设置变量" class="header-anchor">#</a> 8.设置变量</h3> <p>set host 192.168.200.200</p> <h1 id="脚本开发练习"><a href="#脚本开发练习" class="header-anchor">#</a> 脚本开发练习</h1> <p>1、各类监控脚本，文件、内存、磁盘、端口,URL 监控报警。
2、如何监控网站目录文件是否被篡改，以及站点目录批量被篡改后如何恢复。
3、如何开发各类服务rsync、nginx、mysql等的启动及停止专业脚本（使用chkconfig管理)。
4、如何开发MySQL主从复制监控报警以及自动处理不复制的脚本。·
5、一键配置mysql 多实例、一键配置mysql主从，N多一键部署脚本
6、监控http/mysql/rsync/nfs/memcached等服务是否异常的生产脚本。。
7、一键软件安装及优化，lanmp, linux一键优化，一键数据库安装，优化，配置主从。
8、MySQL多实例启动脚本，分库、分表自动备份脚本。
9、根据网络连接数以及根据 web日志PV封IP的脚本。
10、监控网站的pv以及流量，并且对流量信息进行统计。
11、检查web 服务器多个URL地址是否异常，要可以批量及通用。
12、系统的基础优化一键优化的脚本。
13、清理系统垃圾及文件(过期备份，clientmquene目录等）脚本。
14、tcp连接状态统计。
15、批量创建用户并设置随机8位密码。
16、批量获取服务器信息、批量分发文件。·</p> <p>脚本注释规范</p></div></div> <div class="page-slot page-slot-bottom"><!-- 横向自适应 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6620245489"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="page-edit"><!----> <!----> <!----></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><!----> <a href="/pages/0c4eab/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">shell正则表达式</div></a></div> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/pages/0c4eab/">shell正则表达式</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/613b69/"><div>
            postgresql安装
            <!----></div></a> <span class="date">06-24</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/8ae632/"><div>
            oracle笔记
            <!----></div></a> <span class="date">06-24</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/765fc1/"><div>
            opengauss笔记
            <!----></div></a> <span class="date">06-24</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:48211701@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/opersdev" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://all.aomtop.com" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2022
    <span>kevin | <a href="https://github.com/opersdev" target="_blank">小诺运维</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <div class="custom-html-window custom-html-window-rb" style="display:;"><div class="custom-wrapper"><span class="close-but">×</span> <div><!-- 固定160*160px -->
      <ins class="adsbygoogle"
          style="display:inline-block;max-width:160px;max-height:160px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="8377369658"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
      </div></div></div></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.38f1b0a4.js" defer></script><script src="/assets/js/2.6beb1dc7.js" defer></script><script src="/assets/js/12.aa21f453.js" defer></script>
  </body>
</html>
